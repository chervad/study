<!DOCTYPE html>
<!-- saved from url=(0032)https://habr.com/ru/post/343778/ -->
<html lang="ru" class="no-js fonts-loaded"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/osd.js"></script><script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/pubads_impl_rendering_2019043001.js"></script><script type="text/javascript" async="" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/js"></script><script async="" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/analytics.js"></script>
    
<meta content="width=1024" name="viewport">
<title>Шаблон проектирования Entity-Component-System — реализация и пример игры / Хабр</title>

  <meta name="description" content="

В этой статье я хочу обсудить шаблон проектирования «сущность-компонент-система» (Entity-Component-System, ECS). По этой теме можно найти много информации в Интернете, поэтому я не буду глубоко...">

  <meta name="keywords" content="шаблоны проектирования, entity component system, программирование игр, сущность компонент система">

  <meta property="fb:app_id" content="444736788986613">
<meta property="og:type" content="article">
<meta property="fb:pages" content="472597926099084">
<meta property="og:url" content="https://habr.com/ru/post/343778/">
<meta property="og:title" content="Шаблон проектирования Entity-Component-System — реализация и пример игры">

    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/db6/486/421/db6486421d2282d555d5ac5af577aafc.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/db6486421d2282d555d5ac5af577aafc.png">
      <meta name="twitter:image" content="https://habrastorage.org/getpro/habr/post_images/db6/486/421/db6486421d2282d555d5ac5af577aafc.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/8da/8fd/bbc/8da8fdbbc5568237ae5450a90a835799.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/8da8fdbbc5568237ae5450a90a835799.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/337/c95/574/337c95574903fbebe3d34908c381eafa.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/337c95574903fbebe3d34908c381eafa.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/4ff/3e4/79b/4ff3e479b1cb32a422d08125e9d7953f.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/4ff3e479b1cb32a422d08125e9d7953f.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/206/fc4/567/206fc456770c4c07298d4f3c157a833a.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/206fc456770c4c07298d4f3c157a833a.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/f4d/4e8/505/f4d4e850588b44bf32d7fd41c61ec4ff.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/f4d4e850588b44bf32d7fd41c61ec4ff.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/0b9/1b3/8b8/0b91b38b82d5a16556ceb39616b43a0f.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/0b91b38b82d5a16556ceb39616b43a0f.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/6c4/fd3/8e8/6c4fd38e8d700ce208a873299571770b.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/6c4fd38e8d700ce208a873299571770b.png">
    <meta property="og:image" content="https://habrastorage.org/getpro/habr/post_images/e58/818/3eb/e588183eb0e95a0225ca34a957f16480.png">
    <link rel="image_src" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/e588183eb0e95a0225ca34a957f16480.png">

<meta property="og:description" content="В этой статье я хочу обсудить шаблон проектирования «сущность-компонент-система» (Entity-Component-System, ECS). По этой теме можно найти много информации в Ин...">
<meta name="twitter:description" content="В этой статье я хочу обсудить шаблон проектирования «сущность-компонент-система» (Entity-Component-System, ECS). По этой теме можно найти много информации в Ин...">
<meta name="twitter:title" content="Шаблон проектирования Entity-Component-System — реализация и пример игры">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@habr_com">

  <meta property="al:android:url" content="habrahabr://post/343778">
<meta property="al:android:app_name" content="Habrahabr">
<meta property="al:android:package" content="ru.habrahabr">
<meta property="al:windows_phone:url" content="habrahabr://post/343778">
<meta property="al:windows_phone:app_name" content="Habrahabr">
<meta property="al:windows_phone:app_id" content="460a6bd6-8955-470f-935e-9ea1726a6060">

  <link rel="canonical" href="https://habr.com/ru/post/343778/">
  <link rel="alternate" media="only screen and (max-width: 640px)" href="https://m.habr.com/ru/post/343778/">

    <script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/inferredEvents.js" async=""></script><script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/317458588730613" async=""></script><script async="" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/fbevents.js"></script><script type="text/javascript" async="" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/watch.js"></script><script type="text/javascript" async="" defer="" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/saved_resource" charset="UTF-8"></script><script type="application/ld+json">
      {
    "@context": "http:\/\/schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/habr.com\/ru\/post\/343778\/"
    },
    "headline": "Шаблон проектирования Entity-Component-System — реализация и пример игры",
    "datePublished": "2017-12-05T11:04:48+03:00",
    "dateModified": "2017-12-05T12:30:22+03:00",
    "author": {
        "@type": "Person",
        "name": "PatientZero"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Habr",
        "logo": {
            "@type": "ImageObject",
            "url": "https:\/\/dr.habracdn.net\/habrcom\/images\/habr_google.png"
        }
    },
    "description": "В этой статье я хочу обсудить шаблон проектирования &laquo;сущность-компонент-система&raquo; (Entity-Component-System, ECS). По этой теме можно найти много информации в Ин...",
    "image": [
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/db6\/486\/421\/db6486421d2282d555d5ac5af577aafc.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/8da\/8fd\/bbc\/8da8fdbbc5568237ae5450a90a835799.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/337\/c95\/574\/337c95574903fbebe3d34908c381eafa.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/4ff\/3e4\/79b\/4ff3e479b1cb32a422d08125e9d7953f.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/206\/fc4\/567\/206fc456770c4c07298d4f3c157a833a.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/f4d\/4e8\/505\/f4d4e850588b44bf32d7fd41c61ec4ff.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/0b9\/1b3\/8b8\/0b91b38b82d5a16556ceb39616b43a0f.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/6c4\/fd3\/8e8\/6c4fd38e8d700ce208a873299571770b.png",
        "https:\/\/habrastorage.org\/getpro\/habr\/post_images\/e58\/818\/3eb\/e588183eb0e95a0225ca34a957f16480.png"
    ]
}
    </script>


<meta name="yandex-verification" content="71593b225aeafc4e">
<meta name="referrer" content="unsafe-url">
<meta name="pocket-site-verification" content="ed24b2b9721edf0a282c5b4a3232c4">


<style type="text/css">
  @font-face{font-family:'Fira Sans';font-style:normal;font-weight:500;src:url(/fonts/0/FiraSans/firaSans-medium.eot);src:local("Fira Sans Medium"),local("FiraSans-Medium"),url(/fonts/0/FiraSans/firaSans-medium.eot?#iefix) format("embedded-opentype"),url(/fonts/0/FiraSans/firaSans-medium.woff2) format("woff2"),url(/fonts/0/FiraSans/firaSans-medium.woff) format("woff"),url(/fonts/0/FiraSans/firaSans-medium.ttf) format("truetype")}
</style>

<link href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/main.bundle.css" rel="stylesheet" media="all">





<meta name="yandex-verification" content="67d46b975fa41645">

<link rel="apple-touch-icon" sizes="180x180" href="https://habr.com/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://habr.com/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://habr.com/images/favicon-16x16.png">
<link rel="manifest" href="https://habr.com/site.webmanifest">
<link rel="mask-icon" href="https://habr.com/images/safari-pinned-tab.svg" color="#77a2b6">
<meta name="application-name" content="Хабр">
<meta name="msapplication-TileColor" content="#77a2b6">
<meta name="theme-color" content="#77a2b6">


  <link title="Комментарии к публикации «Шаблон проектирования Entity-Component-System — реализация и пример игры»" type="application/rss+xml" rel="alternate" href="https://habr.com/ru/rss/post/343778/">

<script>/* Font Face Observer v2.0.13 - © Bram Stein. License: BSD-3-Clause */(function(){'use strict';var f,g=[];function l(a){g.push(a);1==g.length&&f()}function m(){for(;g.length;)g[0](),g.shift()}f=function(){setTimeout(m)};function n(a){this.a=p;this.b=void 0;this.f=[];var b=this;try{a(function(a){q(b,a)},function(a){r(b,a)})}catch(c){r(b,c)}}var p=2;function t(a){return new n(function(b,c){c(a)})}function u(a){return new n(function(b){b(a)})}function q(a,b){if(a.a==p){if(b==a)throw new TypeError;var c=!1;try{var d=b&&b.then;if(null!=b&&"object"==typeof b&&"function"==typeof d){d.call(b,function(b){c||q(a,b);c=!0},function(b){c||r(a,b);c=!0});return}}catch(e){c||r(a,e);return}a.a=0;a.b=b;v(a)}}
function r(a,b){if(a.a==p){if(b==a)throw new TypeError;a.a=1;a.b=b;v(a)}}function v(a){l(function(){if(a.a!=p)for(;a.f.length;){var b=a.f.shift(),c=b[0],d=b[1],e=b[2],b=b[3];try{0==a.a?"function"==typeof c?e(c.call(void 0,a.b)):e(a.b):1==a.a&&("function"==typeof d?e(d.call(void 0,a.b)):b(a.b))}catch(h){b(h)}}})}n.prototype.g=function(a){return this.c(void 0,a)};n.prototype.c=function(a,b){var c=this;return new n(function(d,e){c.f.push([a,b,d,e]);v(c)})};
function w(a){return new n(function(b,c){function d(c){return function(d){h[c]=d;e+=1;e==a.length&&b(h)}}var e=0,h=[];0==a.length&&b(h);for(var k=0;k<a.length;k+=1)u(a[k]).c(d(k),c)})}function x(a){return new n(function(b,c){for(var d=0;d<a.length;d+=1)u(a[d]).c(b,c)})};window.Promise||(window.Promise=n,window.Promise.resolve=u,window.Promise.reject=t,window.Promise.race=x,window.Promise.all=w,window.Promise.prototype.then=n.prototype.c,window.Promise.prototype["catch"]=n.prototype.g);}());

(function(){function l(a,b){document.addEventListener?a.addEventListener("scroll",b,!1):a.attachEvent("scroll",b)}function m(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function c(){document.removeEventListener("DOMContentLoaded",c);a()}):document.attachEvent("onreadystatechange",function k(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",k),a()})};function r(a){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(a));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}
function t(a,b){a.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+b+";"}function y(a){var b=a.a.offsetWidth,c=b+100;a.f.style.width=c+"px";a.c.scrollLeft=c;a.b.scrollLeft=a.b.scrollWidth+100;return a.g!==b?(a.g=b,!0):!1}function z(a,b){function c(){var a=k;y(a)&&a.a.parentNode&&b(a.g)}var k=a;l(a.b,c);l(a.c,c);y(a)};function A(a,b){var c=b||{};this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal"}var B=null,C=null,E=null,F=null;function G(){if(null===C)if(J()&&/Apple/.test(window.navigator.vendor)){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);C=!!a&&603>parseInt(a[1],10)}else C=!1;return C}function J(){null===F&&(F=!!document.fonts);return F}
function K(){if(null===E){var a=document.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(b){}E=""!==a.style.font}return E}function L(a,b){return[a.style,a.weight,K()?a.stretch:"","100px",b].join(" ")}
A.prototype.load=function(a,b){var c=this,k=a||"BESbswy",q=0,D=b||3E3,H=(new Date).getTime();return new Promise(function(a,b){if(J()&&!G()){var M=new Promise(function(a,b){function e(){(new Date).getTime()-H>=D?b():document.fonts.load(L(c,'"'+c.family+'"'),k).then(function(c){1<=c.length?a():setTimeout(e,25)},function(){b()})}e()}),N=new Promise(function(a,c){q=setTimeout(c,D)});Promise.race([N,M]).then(function(){clearTimeout(q);a(c)},function(){b(c)})}else m(function(){function u(){var b;if(b=-1!=
f&&-1!=g||-1!=f&&-1!=h||-1!=g&&-1!=h)(b=f!=g&&f!=h&&g!=h)||(null===B&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),B=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=B&&(f==v&&g==v&&h==v||f==w&&g==w&&h==w||f==x&&g==x&&h==x)),b=!b;b&&(d.parentNode&&d.parentNode.removeChild(d),clearTimeout(q),a(c))}function I(){if((new Date).getTime()-H>=D)d.parentNode&&d.parentNode.removeChild(d),b(c);else{var a=document.hidden;if(!0===a||void 0===a)f=e.a.offsetWidth,
g=n.a.offsetWidth,h=p.a.offsetWidth,u();q=setTimeout(I,50)}}var e=new r(k),n=new r(k),p=new r(k),f=-1,g=-1,h=-1,v=-1,w=-1,x=-1,d=document.createElement("div");d.dir="ltr";t(e,L(c,"sans-serif"));t(n,L(c,"serif"));t(p,L(c,"monospace"));d.appendChild(e.a);d.appendChild(n.a);d.appendChild(p.a);document.body.appendChild(d);v=e.a.offsetWidth;w=n.a.offsetWidth;x=p.a.offsetWidth;I();z(e,function(a){f=a;u()});t(e,L(c,'"'+c.family+'",sans-serif'));z(n,function(a){g=a;u()});t(n,L(c,'"'+c.family+'",serif'));
z(p,function(a){h=a;u()});t(p,L(c,'"'+c.family+'",monospace'))})})};"object"===typeof module?module.exports=A:(window.FontFaceObserver=A,window.FontFaceObserver.prototype.load=A.prototype.load);}());

(function( w ){
if( w.document.documentElement.className.indexOf( "fonts-loaded" ) > -1 ){ return; }

var html = document.documentElement;
var FS500 = new w.FontFaceObserver("Fira Sans", { weight: 500 });

FS500.load().then(function() {
html.classList.add('fonts-loaded');
sessionStorage.fontsLoaded = true;
console.log('FS500-loaded');
}).catch(function () {
sessionStorage.fontsLoaded = false;
console.log('FS500-unloaded');
});

if (sessionStorage.fontsLoaded) {
html.classList.add('fonts-loaded');
}
}(this));
</script>
<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/jquery-1.8.3.min.js"></script>
<script>
  window.create_callback_for_blocked = function(key) {
    return function() {
      googletag.cmd.push(function () {
        googletag.display(key);
      });
    }
  }

  window.habr_blockers_checker = new function() {
    var result;
    var callbacksQueue = [];
    var calledOnce = false;

    function fireCallbacks() {
      callbacksQueue.forEach(function(callback) {
        callback(result);
      });
      callbacksQueue = [];
    }

    this.detect = function(imgUrl, callback) {
      var checksRemain = 2;
      var detected = false;
      var error1 = false;
      var error2 = false;

      if (typeof callback !== 'function') {
        return;
      };

      callbacksQueue.push(callback);

      if (typeof result !== 'undefined') {
        fireCallbacks();
      };

      if (calledOnce) {
        return;
      }
      calledOnce = true;

      imgUrl += '?ch=*&rn=*';

      function beforeCheck(timeout) {
        if (checksRemain === 0 || timeout > 1E3) {
          result = checksRemain === 0 && detected;
          fireCallbacks();
        } else {
          setTimeout(function() {
            beforeCheck(timeout * 2)
          }, timeout * 2);
        }
      }

      function checkImages() {
        if (--checksRemain) {
          return;
        };
        detected = !error1 && error2;
      }

      var random = Math.random() * 11;

      var img1 = new Image;
      img1.onload = checkImages;
      img1.onerror = function() {
        error1 = true;
        checkImages()
      };
      img1.src = imgUrl.replace(/\*/, 1).replace(/\*/, random);

      var img2 = new Image;
      img2.onload = checkImages;
      img2.onerror = function() {
        error2 = true;
        checkImages()
      };
      img2.src = imgUrl.replace(/\*/, 2).replace(/\*/, random);

      beforeCheck(250, callback)
    };

    this.detectWrapper = function(callback) {
      return this.detect('/images/px.gif', callback);
    };
  };

  window.display_dfp_slot = function(key) {
    if (window.habr_blockers_checker) {
      window.habr_blockers_checker.detectWrapper(window.create_callback_for_blocked(key));
    } else {
      window.create_callback_for_blocked(key)();
    }
  };
</script>


<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/raven.min.js"></script>
<script>Raven.config('https://830576edd4b7478086093f693a5a0df5@s.tmtm.ru/37').install()</script>

<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/advertise.js"></script>
<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/adriver.js"></script>
<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/gpt.js" async=""></script>
<script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/publishertag.js" async=""></script>

<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>

<script>
  // TODO: move this code to module
  //       move dot in chains to start of line and use one indent level:
  //               ```
  //                  start()
  //                    .chainEnd()
  //               ```
  function display_yandex_rtb(yandexId, divId) {
    $('#' + divId).show();
    (function(w, d, n, s, t) {
      w[n] = w[n] || [];
      w[n].push(function() {
        Ya.Context.AdvManager.render({
          blockId: yandexId,
          renderTo: divId,
          async: true
        });
      });
      t = d.getElementsByTagName('script')[0];
      s = d.createElement('script');
      s.type = 'text/javascript';
      s.src = '//an.yandex.ru/system/context.js';
      s.async = true;
      t.parentNode.insertBefore(s, t);
    })(this, this.document, 'yandexContextAsyncCallbacks');
  }

  function listen_googletag_and_render_yandex(yandexId, targetDivId) {
    if (!window.googletag || !window.googletag.cmd) {
      return;
    }
    window.googletag.cmd.push(function() {
      if (!window.googletag.pubads) {
        return;
      }

      window.googletag.pubads()
        .addEventListener('slotRenderEnded', function(event) {
          var divId = event.slot.getSlotElementId();
          if (divId === targetDivId && event.isEmpty) {
            window.display_yandex_rtb(yandexId, divId);
          }
        });
    });
  }

  function getRoxotItem(storageKey, config) {
    if (config) {
      var { randomVal, returnCode } = config;
    } else {
      var randomVal = 100,
          returnCode = '101';
    }
    try {
      var groupId = localStorage.getItem(storageKey);
      if (groupId === null) {
        groupId = 1 + Math.floor(Math.random() * randomVal);
        localStorage.setItem(storageKey, groupId);
      }
      return '' + groupId;
    }
    catch (e) {
      return returnCode;
    }
  }

  function getRoxotEvent() {
    return '' + (1 + Math.floor(Math.random() * 100));
  }

  function leftpad(str, len, ch) {
    str = String(str);

    var i = -1;

    if (!ch && ch !== 0) {
      ch = ' ';
    };

    len = len - str.length;

    while (++i < len) {
      str = ch + str;
    }

    return str;
  }

  var WEEK_DAYS = ['su', 'mo', 'tu', 'we', 'th', 'fr', 'sa'];

  function initializeDFP(usesABP) {
    var currentDate = new Date();
    var hours = currentDate.getHours();
    var hoursStr = leftpad(hours, 2, '0');
    var weekDayCode = WEEK_DAYS[currentDate.getDay()];
    googletag.cmd.push(function() {
      if (usesABP) {
  googletag.defineSlot('/235032688/HH/HH01_ATF_Poster', [[300, 500], [300, 250], [300, 300], [300, 400], [300, 200], [300, 100], [240, 400]], 'div-gpt-hh-atf').addService(googletag.pubads());
  window.listen_googletag_and_render_yandex('R-A-149298-31', 'div-gpt-hh-atf');
} else {
  googletag.defineSlot('/235032688/HH/HH01_ATF_Poster', [[300, 500], [300, 600], [300, 250], [300, 300], [300, 400], [300, 200], [300, 150], [300, 100], [240, 400]], 'div-gpt-hh-atf').addService(googletag.pubads());
  window.listen_googletag_and_render_yandex('R-A-149298-35', 'div-gpt-hh-atf');
}

      googletag.pubads().enableSingleRequest();
      if (!usesABP) {
        googletag.pubads().disableInitialLoad(); //We will wait for the Criteo Bidder Call before calling the adserver
      }
      googletag.pubads().collapseEmptyDivs();
      googletag.pubads().
      setTargeting('roxot-group-id', getRoxotItem('roxot-gid', { randomVal: 10000, returnCode: '10001'})).
      setTargeting('roxot-sector-id', getRoxotItem('roxot-sid')).
      setTargeting('roxot-deep', getRoxotItem('roxot-deep')).
      setTargeting('roxot-event-group-id', getRoxotEvent()).
      setTargeting('roxot-event', getRoxotEvent()).
      setTargeting('roxot-event-deep', getRoxotEvent()).
      setTargeting('roxot-minutes', (new Date).getUTCMinutes().toString()).
      setTargeting('roxot-hours', (new Date).getUTCHours().toString()).
      setTargeting('roxot-day', (new Date).getUTCDay().toString()).
      setTargeting('chr', hoursStr).
      setTargeting('cwd', weekDayCode).
      setTargeting('aa', (usesABP) ? 'yes' : 'no').
      setTargeting('path', window.location.pathname + window.location.search).
      setTargeting('cat', ["h_programming","h_cpp","h_gamedev","f_develop","t_шаблоны_проектирования","t_entity_component_system","t_программирование_игр","t_сущность_компонент_система"]).
      setTargeting('dev', [0]).
      setTargeting('user', ["guest","registered"]).
      setTargeting('pagetype', ["post"]).
      setTargeting('posttype', ["translation"]).
      setTargeting('postid', [343778]);
      googletag.enableServices();

      if (!usesABP) {
        window.Criteo = window.Criteo || {};
        window.Criteo.events = window.Criteo.events || [];
        var launchAdServer = function () {
          googletag.cmd.push(function () {
            Criteo.SetDFPKeyValueTargeting(); //This will append Criteo keywords to the adserver call
            googletag.pubads().refresh(); //This will trigger the adserver call
          });
        };
        Criteo.events.push(function () {
          var adUnits = {
            'placements': [
              {'slotid': 'div-gpt-hh-atf', 'zoneid': 1173489}, // TMTM - RU - CDB - SA - Habr - 300x600
            ]
          };
          // Define the price band range
          Criteo.SetLineItemRanges('0..599:1;600..1398:2;1400..3000:5');
          // Call Criteo and execute the callback function for a given timeout
          Criteo.RequestBids(adUnits, launchAdServer, 750);
        });
      }
    });
  }
  if (window.habr_blockers_checker) {
    window.habr_blockers_checker.detectWrapper(initializeDFP);
  } else {
    initializeDFP(false);
  }
</script>

<script type="text/javascript">
  function callGA(usesABP) {
    if (typeof window.adb1 === 'undefined') { window.adb1 = 'yes';}
    if (usesABP) { window.adb1 = 'aa'; }

    var user_type = 'guest';

    var page_type = "publish_editorial";

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-726094-1',  'auto');
        ga('create', 'UA-726094-24', 'auto', {'name': 'HGM', 'allowLinker': true});


    ga('HGM.require', 'linker');
    ga('HGM.linker:autoLink', ['toster.ru', 'habr.com', 'account.habr.com', 'm.habr.com']);

    ga('require', 'displayfeatures');
    ga('set', 'dimension1', user_type); // user type - guest/readonly/habrauser
    ga('set', 'dimension2', page_type);
    ga('set', 'dimension3', 'na');
    ga('set', 'dimension4', window.adb1);
    ga('set', 'dimension6', 'ru');


    (function() {
      var removeUtms = function(){
        var location = window.location;
        if (location.search.indexOf('utm_') != -1 && history.replaceState) {
          var currentUrl = location.toString();
          var strippedUrl = currentUrl.replace(/\?([^#]*)/, function(_, search) {
            var result = search.split('&').map(function(param) {
              if (/^utm_/.test(param)) {
                return '';
              }
              return param;
            }).filter(Boolean).join('&');
            return result ? '?' + result : '';
          });

          history.replaceState({}, '', strippedUrl);
        }
      };
      ga('require', 'GTM-559GVC8');
      ga('send', 'pageview', { 'hitCallback': removeUtms });
    })();

    ga('HGM.set', 'dimension1', user_type);
    ga('HGM.set', 'dimension2', "habrahabr");
    ga('HGM.set', 'dimension4', window.adb1);

    ga('HGM.send', 'pageview');
  }


  if (window.habr_blockers_checker) {
    window.habr_blockers_checker.detectWrapper(callGA);
  } else {
    callGA(false)
  }

</script>


  <link rel="preload" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/integrator.js" as="script"><script type="text/javascript" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/integrator.js"></script><link rel="preload" href="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/integrator(1).js" as="script"><script type="text/javascript" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/integrator(1).js"></script><script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/pubads_impl_2019043001.js" async=""></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_SVG_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax_SVG .MJX-monospace {font-family: monospace}
.MathJax_SVG .MJX-sans-serif {font-family: sans-serif}
#MathJax_SVG_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax_SVG {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax_SVG * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.mjx-svg-href {fill: blue; stroke: blue}
.MathJax_SVG_Processing {visibility: hidden; position: absolute; top: 0; left: 0; width: 0; height: 0; overflow: hidden; display: block!important}
.MathJax_SVG_Processed {display: none!important}
.MathJax_SVG_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
.MathJax_SVG_LineBox {display: table!important}
.MathJax_SVG_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax_SVG .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

  <body class="nl"><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"></defs></svg></div>

    <div class="layout">
      <div class="layout__row layout__row_services">
        <div id="TMpanel">
  <div class="container">
    <div class="bmenu">
      <a href="https://habr.com/?utm_source=tm_habrahabr&amp;utm_medium=tm_top_panel&amp;utm_campaign=tm_promo" class="current">Хабр</a>
      <a href="https://habr.com/flows/geektimes/">Geektimes</a>
      <a href="https://toster.ru/?utm_source=tm_habrahabr&amp;utm_medium=tm_top_panel&amp;utm_campaign=tm_promo">Тостер</a>
      <a href="https://moikrug.ru/?utm_source=tm_habrahabr&amp;utm_medium=tm_top_panel&amp;utm_campaign=tm_promo">Мой круг</a>
      <a href="https://freelansim.ru/?utm_source=tm_habrahabr&amp;utm_medium=tm_top_panel&amp;utm_campaign=tm_promo">Фрилансим</a>
    </div>
        <div class="bmenu_inner" style="display:inline-block!important;visibility:visible!important;">
          <span class="bmenu__label">Мегапосты:</span>
          <span class="bmenu slink"><a href="https://u.tmtm.ru/huawei_wifi6_glagne" target="_blank" style="color: #3c86ee" rel=" noopener">Вскрываем Wi-Fi 6</a><a href="https://u.tmtm.ru/u-inno-q-050419" target="_blank" style="color: #31B007" rel=" noopener">Иннополис-квест</a><a href="https://u.tmtm.ru/Kaspersky_Sadovnikov_04_2019_glagne" target="_blank" style="color: #00008B" rel=" noopener">С++страдание</a></span>
        </div>
  </div>
</div>

      </div>

      <div class="layout__row layout__row_navbar">
        <div class="layout__cell">
          <div class="main-navbar">
  <div class="main-navbar__section main-navbar__section_left">
    <span class="logo-wrapper">
      <a href="https://habr.com/ru/" class="logo" title="">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon-svg icon-svg_logo-habrahabr" width="71" height="26" viewBox="0 0 92 32"><path d="M6.827 12.278c1.273-1.735 3.304-2.848 5.595-2.848l.521.019-.023-.001c4.272 0 7.587 2.988 7.587 7.941v14.047h-6.827v-11.636c0-2.529-1.31-3.931-3.381-3.931-1.9 0-3.473 1.31-3.473 4.062v11.505h-6.827v-31.45h6.827zM46.611 31.437h-6.552v-2.319c-1.357 1.764-3.468 2.89-5.843 2.89l-.332-.007.016.001c-5.713 0-9.946-4.98-9.946-11.296s4.233-11.256 9.972-11.256l.288-.006c2.378 0 4.491 1.131 5.832 2.884l.013.018v-2.306h6.552zm-15.725-10.72c0 2.533 2.053 4.586 4.586 4.586s4.586-2.053 4.586-4.586c0-2.533-2.053-4.586-4.586-4.586s-4.586 2.053-4.586 4.586zM73.959 20.704c0 6.316-4.246 11.296-9.959 11.296l-.342.008c-2.354 0-4.446-1.116-5.778-2.848l-.013-.017v2.293h-6.552v-31.45h6.814v12.095c1.343-1.61 3.351-2.628 5.596-2.628l.329.007-.016-.001c5.674-.013 9.92 4.94 9.92 11.243zm-16.157 0c0 2.533 2.053 4.586 4.586 4.586s4.586-2.053 4.586-4.586c0-2.533-2.053-4.586-4.586-4.586s-4.586 2.053-4.586 4.586zM92.318 9.776l-.59 6.801c-1.019-.342-2.193-.547-3.412-.563h-.008c-.15-.023-.323-.036-.498-.036-1.911 0-3.459 1.549-3.459 3.459 0 .151.01.3.029.447l-.002-.017v11.571h-6.84v-21.399h6.552v2.464c1.124-1.85 3.128-3.068 5.417-3.068l.448.016-.02-.001h.022c.842 0 1.655.12 2.425.343l-.061-.015z"></path></svg>

      </a>
      
    </span>
    <ul class="nav-links" id="navbar-links">
  <li class="nav-links__item">
    <a href="https://habr.com/ru/" class="nav-links__item-link ">Публикации</a>
  </li>
  <li class="nav-links__item">
    <a href="https://habr.com/ru/news/" class="nav-links__item-link ">Новости</a>
  </li>
  <li class="nav-links__item">
    <a href="https://habr.com/ru/users/" class="nav-links__item-link ">Пользователи</a>
  </li>
  <li class="nav-links__item">
    <a href="https://habr.com/ru/hubs/" class="nav-links__item-link ">Хабы</a>
  </li>
  <li class="nav-links__item">
    <a href="https://habr.com/ru/companies/" class="nav-links__item-link ">Компании</a>
  </li>
  <li class="nav-links__item">
    <a href="https://habr.com/ru/sandbox/" class="nav-links__item-link ">Песочница</a>
  </li>
</ul>

    <form action="https://habr.com/ru/search/#h" method="get" class="search-form" id="search-form">
  <button type="button" class="btn btn_navbar_search icon-svg_search" id="search-form-btn" title="Поиск по сайту">
    <svg class="icon-svg" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" version="1.1" role="img"><path d="M21.416 13.21c0 4.6-3.65 8.34-8.14 8.34S5.11 17.81 5.11 13.21c0-4.632 3.65-8.373 8.167-8.373 4.488 0 8.14 3.772 8.14 8.372zm1.945 7.083c1.407-2.055 2.155-4.57 2.155-7.084C25.515 6.277 20.04.665 13.277.665S1.04 6.278 1.04 13.21c0 6.93 5.475 12.542 12.237 12.542 2.454 0 4.907-.797 6.942-2.208l7.6 7.79 3.14-3.22-7.6-7.82z"></path></svg>
  </button>
  <label class="search-form__field-wrapper">
    <input type="text" name="q" class="search-form__field" id="search-form-field" placeholder="Поиск" tabindex="-1">
    <button type="button" class="btn btn_search-close" id="search-form-clear" title="Закрыть">
      <svg class="icon-svg icon-svg_navbar-close-search" width="31" height="32" viewBox="0 0 31 32" aria-hidden="true" version="1.1" role="img"><path d="M26.67 0L15.217 11.448 3.77 0 0 3.77l11.447 11.45L0 26.666l3.77 3.77L15.218 18.99l11.45 11.448 3.772-3.77-11.448-11.45L30.44 3.772z"></path></svg>

    </button>
  </label>
</form>

  </div>

  <div class="main-navbar__section main-navbar__section_right">
        <button type="button" class="btn btn_medium btn_navbar_lang js-show_lang_settings">
          <svg class="icon-svg" width="18" height="18">
            <use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#globus"></use>
          </svg>
        </button>
      <a href="https://habr.com/ru/auth/login/" id="login" class="btn btn_medium btn_navbar_login">Войти</a>
      <a href="https://habr.com/ru/auth/register/" class="btn btn_medium btn_navbar_registration">Регистрация</a>


  </div>
</div>

        </div>
      </div>

      <div class="layout__row layout__row_body">
        <div class="layout__cell layout__cell_body">
          
            
  
  
  <section class="column-wrapper column-wrapper_post js-sticky-wrapper">
    <div class="content_left js-content_left">
      
    <article class="post post_full" id="post_343778">
  <div class="post__wrapper">
    <header class="post__meta">
        <a href="https://habr.com/ru/users/PatientZero/" class="post__user-info user-info" title="Автор публикации">
            <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/8de9c534a18a6cb8693270a2b528d4c0.png" width="24" height="24" class="user-info__image-pic user-info__image-pic_small">
          <span class="user-info__nickname user-info__nickname_small">PatientZero</span>
        </a>

      <span class="post__time" data-time_published="2017-12-05T08:04Z">5 декабря 2017 в 11:04</span>

      
    </header>

    <h1 class="post__title post__title_full">
      <span class="post__title-text">Шаблон проектирования Entity-Component-System — реализация и пример игры</span>
    </h1>

      <div class="post__translatation">
        <a href="https://tsprojectsblog.wordpress.com/portfolio/entity-component-system/" class="post__translatation-link" title="Автор оригинала: Tobias Stein" target="_blank" rel=" noopener">Автор оригинала: Tobias Stein</a>
      </div>

      <ul class="post__hubs post__hubs_full-post inline-list">
          <li class="inline-list__item inline-list__item_hub">
            <a href="https://habr.com/ru/hub/programming/" class="inline-list__item-link hub-link " title="Вы не подписаны на этот хаб" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;hub&#39;, &#39;post page&#39;, &#39;Программирование&#39;); }">Программирование</a>, 
          </li>
          <li class="inline-list__item inline-list__item_hub">
            <a href="https://habr.com/ru/hub/cpp/" class="inline-list__item-link hub-link " title="Вы не подписаны на этот хаб" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;hub&#39;, &#39;post page&#39;, &#39;C++&#39;); }">C++</a>, 
          </li>
          <li class="inline-list__item inline-list__item_hub">
            <a href="https://habr.com/ru/hub/gamedev/" class="inline-list__item-link hub-link " title="Вы не подписаны на этот хаб" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;hub&#39;, &#39;post page&#39;, &#39;Разработка игр&#39;); }">Разработка игр</a>
          </li>
      </ul>

    <ul class="post__marks inline-list"><li class="inline-list__item inline-list__item_post-type"><span class="post__type-label" title="Перевод">Перевод</span></li></ul>

    <div class="post__body post__body_full">
      <div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/db6486421d2282d555d5ac5af577aafc.png" alt="image"></div><br>
<br>
В этой статье я хочу обсудить шаблон проектирования «сущность-компонент-система» (Entity-Component-System, <strong>ECS</strong>). По этой теме можно найти много информации в Интернете, поэтому я не буду глубоко вдаваться в объяснения, а больше расскажу о моей собственной реализации.<br>
<br>
<h2>Часть 1: Реализация шаблона Entity-Component-System на C++</h2><br>
Начнём сначала. Полный исходный код моей реализации ECS можно найти в репозитории на <a href="https://github.com/tobias-stein/EntityComponentSystem" rel="noopener">github</a>.<br>
<br>
Entity-Component-System, в основном используемый в играх — это шаблон проектирования, обеспечивающий огромную гибкость в проектировании общей архитектуры программного обеспечения<sup>[1]</sup>. Такие большие компании, как Unity, Epic или Crytek используют этот шаблон в своих фреймворках, чтобы предоставить разработчикам очень богатый возможностями инструмент, с помощью которого они могут разрабатывать собственное ПО. Прочитать более широкое обсуждение по этой тематике можно в этих постах <sup>[2,3,4,5]</sup>.<br>
<a name="habracut"></a><br>
Если вы изучите эти статьи, то заметите, что все они имеют общую цель: распределение различных проблем и задач между сущностями (Entities), компонентами (Components) и системами (Systems). Это три основные понятия этого шаблона, и связаны они между собой довольно свободно. <strong>Сущности</strong> обычно используются для создания уникального идентификатора, предоставления среде информации о существовании отдельного элемента и функции как своего рода корневого объекта, объединяющего множество компонентов. <strong>Компоненты</strong> — это не что иное, как объекты-контейнеры, не обладающие никакой сложной логикой. В идеале они являются объектами с простой структурой данных (plain old data objects, POD). Каждый тип компонента можно прикрепить к сущности, чтобы дать ей что-то вроде свойства. Допустим, к сущности можно прикрепить «Health-Component», что позволит сделать её смертной, дав ей <em>здоровье</em>, которое является обычным целочисленным или дробным значением в памяти.<br>
<br>
Большинство статей, которые мне попадались, согласуются друг с другом относительно использования сущностей и компонентов, но мнения о системах разнятся. Некоторые люди считают, что системам известны только компоненты. Более того, некоторые говорят, что для каждого типа компонента должна быть своя система, например для «Collision-Components» должна быть «Collision-System», для «Health-Components» — «Health-System» и т.д. Такой подход довольно строг и не учитывает взаимодействие различных компонентов. Менее строгий подход заключается в том, что различные системы имеют дело с компонентами, о которых им должно быть известно. Например, «Physics-Systems» должна знать о «Collision-Components» и «Rigidbody-Components», потому что обе они скорее всего содержат необходимую для симуляции физики информацию. По моему скромному мнению, <strong>системы</strong> — это «замкнутые среды». То есть они не владеют ни сущностями, ни компонентами. Они имеют доступ к ним через независмые объекты-диспетчеры, которые в свою очередь управляют жизненным циклом сущностей и компонентов.<br>
<br>
Это ставит перед нами интересный вопрос: как сущности, компоненты и системы обмениваются информацией, если они более-менее независимы друг от друга? Ответ может быть разным и зависит от реализации. В моей реализации ответом является event sourcing<sup>[6]</sup>. События распределяются через «диспетчер событий» («Event-Manager») и любой, кому интересны события, может получать передаваемую диспетчером информацию. Если у сущности, системы или даже компонента есть важное изменение состояния, о котором нужно сообщить, например, «изменилась позиция» или «игрок умер», они могут передать информацию «диспетчеру событий». Он передаст событие и все подписанные на это событие узнают о нём. Таким образом можно всё связать друг с другом.<br>
<br>
Похоже, введение оказалось длиннее, чем я планировал, ну что поделаешь. Прежде чем мы углубимся в изучение <a href="https://github.com/tobias-stein/EntityComponentSystem" rel="noopener">кода</a>, который, кстати, написан на C++11, я в общих чертах расскажу об основных характеристиках моей архитектуры:<br>
<br>
<ul>
<li><strong>эффективность использования памяти</strong> — чтобы быстро создавать и удалять объекты сущностей, компонентов и систем, а также события, я не могу полагаться на стандартное управление динамической памятью. Решением в этом случае, конечно же, является собственный распределитель памяти.</li>
<li><strong>журналирование</strong> — чтобы отслеживать происходящее я использовал для журналирования log4cplus<sup>[7]</sup>.</li>
<li><strong>масштабируемость</strong> — возможна удобная реализация новых типов сущностей, компонентов, систем и событий без каких-либо заданных верхних пределов, за исключением системной памяти</li>
<li><strong>гибкость</strong> — между сущностями, компонентами и системами нет никаких зависимостей (разумеется, у сущностей и компонентов есть своего рода зависимость, но они не содержат логики указателей друг на друга)</li>
<li><strong>простой поиск объектов/доступ к ним</strong> — простое получение объектов сущностей и их компонентов через <em>EntityId</em> или итератор компонентов для итерации всех компонентов определённого типа</li>
<li><strong>контроль за выполнением</strong> — системы имеют приоритеты и могут зависеть друг от друга, поэтому можно установить топологический порядок из выполнения</li>
<li><strong>простота использования</strong> — библиотеку запросто можно использовать с другим ПО, достаточно одного include.</li>
</ul><br>
На изображении ниже показана общая архитектура моей реализации Entity-Component-System:<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/8da8fdbbc5568237ae5450a90a835799.png"></div><br>
<i>Рисунок 01: схема архитектуры ECS (<strong><em>ECS.dll</em></strong>).</i><br>
<br>
Как вы видите, на этой схеме есть четыре области разных цветов. Каждая область обозначает модульную часть архитектуры. В самом низу — на самом деле, на схеме в самом верху, она перевёрнута «вниз головой» — у нас находится управление памятью и журналирование (жёлтая область). Эти модули первого уровня работают с очень низкоуровневыми задачами. Они используют модули второго уровня в Entity-Component-System (синяя область) и event sourcing (красная область). Эти модули в основном имеют дело с задачами управления объектами. Поверх них находится модуль третьего уровня ECS_Engine (зелёная область). Этот глобальный объект движка верхнего уровня управляет всеми модулями второго уровня и занимается инициализацией и разрушением. Ну вот, это был краткий и очень абстрактный обзор, теперь давайте рассмотрим архитектуру подробнее.<br>
<br>
<h4>Диспетчер памяти</h4><br>
Давайте начнём с <a href="https://github.com/tobias-stein/EntityComponentSystem/tree/master/EntityComponentSystem/include/ECS/Memory" rel="noopener">Memory-Manager</a>. Его реализация основана на статье<sup>[8]</sup>, найденной мною на <em><a href="https://www.gamedev.net/" rel="noopener">gamedev.net</a></em>. Идея заключается в том, чтобы свести к абсолютному минимуму выделение и освобождение динамической памяти. Поэтому только при запуске приложения с помощью <a href="http://en.cppreference.com/w/cpp/memory/c/malloc" rel="noopener"><em>malloc</em></a> выделяется большая область памяти. Эта память теперь будет управляться одним или несколькими распределителями. Существует множество типов распределителей<sup>[9]</sup> (линейный, стековый, свободный список) и каждый из них имеет свои плюсы и минусы (здесь я не буду их рассматривать). Но несмотря на то, что внутри они работают по-разному, все они имеют общий открытый интерфейс:<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Allocator</span></span></span><span class="hljs-class">
{</span></span>
     <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:
          <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;
          <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">free</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">* p)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;
};</code></pre><br>
Представленный выше фрагмент кода неполон, но в нём видны два основных общих метода, которые должен предоставлять каждый распределитель:<br>
<br>
<ol>
<li><strong>allocate</strong> — выделяет определённое количество байтов и возвращает адрес памяти этой области</li>
<li><strong>free</strong> — освобождает ранее выделенную область памяти с заданным адресом.</li>
</ol><br>
С учётом сказанного, мы можем делать интересные вещи, например, объединять в цепочки несколько распределителей, вот так:<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/337c95574903fbebe3d34908c381eafa.png" alt="image"></div><br>
<i>Рисунок 02: память, управляемая распределителем.</i><br>
<br>
Как видно, один распределитель может получить свою область памяти, которой он будет управлять, от другого (родительского) распределителя, который, в свою очередь, может получить свою память от другого распределителя, и так далее. Таким образом можно выстраивать различные стратегии управления памятью.<br>
<br>
Для реализации моей ECS я создал корневой стековый распределитель, получающий начальную выделенную область в 1 ГБ системной памяти. Модули второго уровня выделяют необходимое им количество памяти из корневого распределителя, и освобождают её только после завершения приложения.<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/4ff3e479b1cb32a422d08125e9d7953f.png" alt="image"></div><br>
<i>Рисунок 03: Возможное распределение глобальной памяти.</i><br>
<br>
На Рисунке 03 показано, как можно распределить память между модулями второго уровня: <em>«Global-Memory-User A»</em> может быть диспетчером сущностей, <em>«Global-Memory-User B»</em> — диспетчером компонентов, а <em>«Global-Memory-User C»</em> — диспетчером систем.<br>
<br>
<h4>Журналирование</h4><br>
Я не буду много говорить о журналировании, потому что я просто воспользовался log4cplus<sup>[7]</sup>, который делает за меня всю работу. Всё, что я сделал, это задал базовый класс <a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/Log/Logger.h" rel="noopener">Logger</a>, определяющий объект <em>log4cplus::Logger</em> и несколько методов-обёрток, передающих простые вызовы журналирования типа «LogInfo()», «LogWarning()» и т.д.<br>
<br>
<h4>Entity-Manager, IEntity, Entity&lt;T&gt;</h4><br>
Хорошо, теперь давайте поговорим о самом «мясе» архитектуры: синей области на Рисунке 01. Вы могли заметить схожую структуру всех объектов-диспетчеров и соответствующих им классов. Например, взгляните на классы <em><a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/EntityManager.h" rel="noopener">EntityManager</a></em>, <a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/IEntity.h" rel="noopener"><em>IEntity</em></a> и <em><a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/EntityComponentSystem/include/ECS/Entity.h" rel="noopener">Entity&lt;T&gt;</a></em>. Класс <em>EntityManger</em> должен управлять <u>всеми</u> объектами сущностей во время выполнения приложения. В его задачи входит создание, удаление и доступ к существующим объектам сущностей. <em>IEntity</em> — это класс-интерфейс, предоставляющий простейшие характеристики объекта сущности, такие как идентификатор объекта и идентификатор (статического) типа. Он является статическим, потому что не меняется после инициализации программы. Этот идентификатор класса постоянен при каждом запуске приложения и может изменяться только при изменении исходного кода.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IEntity</span></span></span><span class="hljs-class">
{</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// код неполон!</span></span>
EntityId m_Id;

    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:
        IEntity();
        <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IEntity();

        <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> EntityTypeId </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetStaticEntityTypeID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;

        <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> EntityId </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEntityID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_Id; }
};</code></pre><br>
Идентификатор типа — это целочисленное значение, меняющееся для каждого конкретного класса сущностей. Это позволяет проверять тип объекта <em>IEntity</em> во время выполнения. Последним по списку, но не по значимости идёт класс-шаблон <em>Entity</em>&lt;T&gt;.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt;
</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entity</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEntity
{
    <span class="hljs-comment"><span class="hljs-comment">// код неполон!</span></span>

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">*)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[](<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>*) = <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:

    <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> EntityTypeId STATIC_ENTITY_TYPE_ID;
Entity() {}
    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~Entity() {}

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> EntityTypeId </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetStaticEntityTypeID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATIC_ENTITY_TYPE_ID; }
};

<span class="hljs-comment"><span class="hljs-comment">// инициализация константы идентификатора типа сущностей</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">template</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> EntityTypeId Entity::STATIC_ENTITY_TYPE_ID = util::Internal::FamilyTypeID::Get();</code></pre><br>
Основное назначение этого класса — инициализация уникального идентификатора типа конкретного класса сущностей. Здесь я воспользовался двумя фактами: во-первых, инициализацией константы<sup>[10]</sup> статичных переменных; во-вторых — природой работы классов-шаблонов. Каждая версия класса-шаблона <em>Entity&lt;T&gt;</em> будет иметь собственную статическую переменную <em>STATIC_ENTITY_TYPE_ID</em>. Она, в свою очередь, гарантированного будет инициализирована до выполнения всех динамических инициализаций. Фрагмент "<em>util::Internal::FamilyTypeID::Get()</em>" используется для реализации чего-то вроде механизма счётчика типов. Он инкрементирует счётчик каждый раз, когда он вызвается с другим <em>T</em>, но всегда возвращает одно значение, когда снова вызывается с одним <em>T</em>. Не уверен, есть ли у такого шаблона своё название, но он довольно удобен. На этом этапе я также избавился от оператора delete и delete[]. Таким образом я сделал невозможным их случайный вызов. Кроме того, благодаря этому (если ваш компилятор достаточно умён) будет выдаваться предупреждение при попытке использования оператора new или new[] для объектов сущностей, потому что противоположного им оператора уже нет. Эти операторы не должны использоваться, потому что всеми их задачами будет заниматься класс <em>EntityManager</em>. Итак, подведём итог того, чему мы уже научились. Класс диспетчера обеспечивает простейшие функции, такие как создание, удаление и доступ к объектам. Класс-интерфейс используется как самый корневой базовый класс и предоставляет уникальный идентификатор объекта и идентификатор типа. Класс-шаблон гарантирует правильную инициализацию идентификатора типа и устраняет оператор delete/delete[]. Тот же самый шаблон классов диспетчера, интерфейса и шаблона используются и для компонентов, систем и событий. Единственное, но важное отличие этих групп заключается в том, как классы-диспетчеры хранят свои объекты и осуществляют к ним доступ.<br>
<br>
Давайте сначала рассмотрим класс EntityManager. На Рисунке 04 показана общая структура хранения элементов.<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/206fc456770c4c07298d4f3c157a833a.png" alt="image"></div><br>
<i>Рисунок 04: Абстрактная схема класса EntityManager и хранения его объектов.</i><br>
<br>
При создании нового объекта сущности нужно использовать метод <em>EntityManager::CreateEntity&lt;<strong>T</strong>&gt;(аргументы…)</em>. Этот общий метод сначала получает параметр шаблона, который является типом создаваемой конкретной сущности. Затем этот метод получает необязательные параметры (их может и не быть), которые передаются конструктору <strong>T</strong>. Передача этих параметров выполняется через шаблон с переменным количеством аргументов<sup>[11]</sup>. Во время создания внутри происходят следующие действия:<br>
<br>
<ol>
<li>Получается <em>ObjectPool<sup>[12]</sup></em> для объектов сущностей типа <strong>T</strong>; если этот пул не существует, то создаётся новый</li>
<li>Из этого пула выделяется память; ровно столько, сколько необходимо для хранения объекта <strong>T</strong></li>
<li>Перед вызовом конструктора <strong>T</strong> от диспетчера получается новый <em>EntityId</em>. Этот идентификатор с ранее выделенной памятью будет сохранён в таблицу поиска; таким образом мы сможем выполнять поиск экземпляра сущности с нужным идентификатором</li>
<li>Затем вызывается замена оператора C++ new <em><sup>[13]</sup></em> с передаваемыми <em>аргументами</em> в качестве входных данных, для создания нового экземпляра <strong>T</strong></li>
<li>наконец, метод возвращает идентификатор сущности.</li>
</ol><br>
После создания нового экземпляра объекта сущности можно получить к нему доступ с помощью его уникального идентификатора <strong>объекта</strong> (<em>EntityId</em>) и <em>EntityManager::GetEntity(EntityId id)</em>. Для разрушения экземпляра объекта сущности нужно вызвать метод <em>EntityManager::DestroyEntity(EntityId id)</em>.<br>
<br>
Класс ComponentManager работает подобным же образом, плюс ещё одно расширение. Кроме пулов объектов для хранения всевозможных объектов он должен представлять дополнительный механизм привязки компонентов к владеющим ими объектами сущностей. Это ограничение приводит к второму этапу поиска: сначала мы проверяем, существует ли сущность с заданным <em>EntityId</em>, и если есть, то проверяем, прикреплён ли к этой сущности определённый тип компонента, выполняя поиск в списке её компонентов.<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/f4d4e850588b44bf32d7fd41c61ec4ff.png" alt="image"></div><br>
<i>Рисунок 05: Схема хранения объекта Component-Manager.</i><br>
<br>
Метод <em>ComponentManager::CreateComponent&lt;T&gt;(EntityId id, аргументы…)</em> позволяет нам добавить к сущности определённый компонент. С помощью <em>ComponentManager::GetComponent&lt;T&gt;(EntityId id)</em> мы можем получать доступ к компонентам сущности, где T определяет тип компонента, к которому мы хотим получить доступ. Если компонент отсутствует, то возвращается <em>nullptr</em>. Для удаления компонента из сущности нужно использовать метод <em>ComponentManager::RemoveComponent&lt;T&gt;(EntityId id)</em>. Но постойте, есть ещё кое-что. Ещё один способ доступа к компонентам — использование <em>ComponentIterator&lt;T&gt;</em>. Таким образом можно итерировать по всем существующим компонентам определённого типа T. Это может быть удобно, например, если такая система, как «Physics-System» должна применить гравитацию ко всем компонентам твёрдых тел.<br>
<br>
Класс SystemManager не имеет каких-то особых дополнений для хранения систем и доступа к ним. Для хранения системы используется простое распределение памяти с идентификатором типа в качестве ключа.<br>
<br>
Класс EventManager использует линейный распределитель, управляющий областью памяти. Эта память используется в качестве буфера событий. События сохраняются в этом буфере и позже передаются. При передаче события буфер очищается и в нём можно сохранять новые события. Это происходит как минимум раз за каждый кадр.<br>
<br>
<img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/0b91b38b82d5a16556ceb39616b43a0f.png" alt="image"><br>
<i>Рисунок 06: Пересмотренная схема архитектуры ECS</i><br>
<br>
Надеюсь, теперь у вас есть какое-то представление о том, как работает структура моей ECS. Если нет, то не волнуйтесь, посмотрите на Рисунок 06 и вкратце её повторите. Как видно, <em>EntityId</em> достаточно важен, потому что мы будем использовать его для доступа к конкретному экземпляру объекта сущности и ко всем его компонентам. Все компоненты знают своего владельца, то есть имея объект компонента, можно легко получить сущность, запросив класс EntityManager с заданным идентификатором владельца этого компонента. Для передачи сущности мы никогда не передаём напрямую указатель, а используем события в сочетании с <em>EntityId</em>. Можно создать конкретное событие, допустим <em>EntityDied</em>, и это событие (которое должно быть объектом с простой структурой данных) имеет элемент типа <em>EntityId</em>. Теперь для уведомления всех получателей события (<em>IEventListener</em>), которые могут быть сущностями, компонентами или системами, мы используем <em>EventManager::SendEvent&lt;EntityDied&gt;(entityId)</em>. Получатель события с другой стороны теперь может использовать переданный <em>EntityId</em> и запросить класс EntityManager для получения объекта сущности или класс ComponentManager для получения определённого компонента этой сущности. Причина этого окружного пути проста — в любой момент выполнения приложения можно какой-нибудь логикой удалить сущность или один из её компонентов. Поскольку мы не будем загромождать код дополнительными действиями по очистке, то воспользуемся <em>EntityId</em>. Если диспетчер возвращает <em>nullptr</em> для этого <em>EntityId</em>, то мы будем знать, что сущность или компонент уже не существует. Кстати, красный квадрат соответствует такому же на Рисунке 01 и обозначает границы ECS.<br>
<br>
<h4>Объект Engine</h4><br>
Чтобы сделать всё немного удобнее, я создал объект движка. Объект движка обеспечивает лёгкую интеграцию и использование клиентского ПО. На стороне клиента достаточно добавить заголовочный файл «ECS/ECS.h» и вызвать метод <em>ECS::Initialize()</em>. Теперь статический глобальный объект движка будет инициализирован (<em>ECS::ECS_Engine</em>) и может использоваться на стороне клиента для получения доступа к классам диспетчеров. Более того, он предоставляет метод <em>SendEvent&lt;T&gt;</em> для рассылки сообщений и метод Update, который автоматически передаёт все события и обновляет все системы. <em>ECS::Terminate()</em> необходимо вызывать перед выходом из основной программы. Это гарантирует, что все полученные ресурсы будут освобождены. В представленном ниже фрагменте кода продемонстрировано простейшее использование глобального объекта движка.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;ECS/ECS.h&gt;</span></span></span></span>

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* argv[])</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-comment"><span class="hljs-comment">// инициализация глобального объекта 'ECS_Engine'</span></span>
    ECS::Initialize();

    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> DELTA_TIME_STEP = <span class="hljs-number"><span class="hljs-number">1.0f</span></span> / <span class="hljs-number"><span class="hljs-number">60.0f</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 60 Гц</span></span>

    <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> bQuit = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;

    <span class="hljs-comment"><span class="hljs-comment">// выполняем основной цикл до выхода</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(bQuit == <span class="hljs-literal"><span class="hljs-literal">false</span></span>)
   {
       <span class="hljs-comment"><span class="hljs-comment">// Обновление всех систем, передача всех событий из буфера,</span></span>
       <span class="hljs-comment"><span class="hljs-comment">// удаление разрушенных компонентов и сущностей ...</span></span>
       ECS::ECS_Engine-&gt;(DELTA_TIME_STEP);
       <span class="hljs-comment"><span class="hljs-comment">/*
           ECS::ECS_Engine-&gt;GetEntityManager()-&gt;...;
           ECS::ECS_Engine-&gt;GetComponentManager()-&gt;...;
           ECS::ECS_Engine-&gt;GetSystemManager()-&gt;...;

           ECS::ECS_Engine-&gt;SendEvent&lt;T&gt;(...);
       */</span></span>
       <span class="hljs-comment"><span class="hljs-comment">// другая логика ...</span></span>
   }

   <span class="hljs-comment"><span class="hljs-comment">// разрушение глобального объекта 'ECS_Engine'</span></span>
   ECS::Terminate();
   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;
}</code></pre><br>
<h4>Заключение</h4><br>
Описанная в этой части статьи архитектура «сущность-компонент-система» полностью функциональна и готова к использованию. Но как обычно, всегда есть мысли по улучшению. Вот всего лишь некоторые из идей, которые пришли мне в голову:<br>
<br>
<ul>
<li>Сделать архитектуру потокобезопасной,</li>
<li>Выполнять каждую систему или группу систем в потоках, с учётом их топологического порядка,</li>
<li>Выполнить рефакторинг event-sourcing и управления памятью, чтобы использовать их как модули,</li>
<li>Сериализация,</li>
<li>Профилирование</li>
<li>…</li>
</ul><br>
Я подготовил демо, чтобы вы могли увидеть мою ECS в действии:<br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%;"><iframe src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/idYdpPCUsyg.html" style="border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;" allowfullscreen="" scrolling="no"></iframe></div></div></div><br>
Демо <em>BountyHunter</em> активно использует ECS и демонстрирует мощь этого шаблона. Во второй части поста я буду рассказывать о нём.<br>
<br>
<h4>Справочные материалы</h4><br>
<sup>[1]</sup><a href="https://en.wikipedia.org/wiki/Entity%E2%80%93component%E2%80%93system" rel="noopener">https://en.wikipedia.org/wiki/Entity-component-system</a><br>
<br>
<sup>[2]</sup><a href="http://gameprogrammingpatterns.com/component.html" rel="noopener">http://gameprogrammingpatterns.com/component.html</a><br>
<br>
<sup>[3]</sup><a href="https://www.gamedev.net/articles/programming/general-and-gameplay-programming/understanding-component-entity-systems-r3013/" rel="noopener">https://www.gamedev.net/articles/programming/general-and-gameplay-programming/understanding-component-entity-systems-r3013/</a><br>
<br>
<sup>[4]</sup><a href="https://github.com/junkdog/artemis-odb/wiki/Introduction-to-Entity-Systems" rel="noopener">https://github.com/junkdog/artemis-odb/wiki/Introduction-to-Entity-Systems</a><br>
<br>
<sup>[5]</sup><a href="http://scottbilas.com/files/2002/gdc_san_jose/game_objects_slides.pdf" rel="noopener">http://scottbilas.com/files/2002/gdc_san_jose/game_objects_slides.pdf</a><br>
<br>
<sup>[6]</sup><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing" rel="noopener">https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing</a><br>
<br>
<sup>[7]</sup><a href="https://sourceforge.net/p/log4cplus/wiki/Home/" rel="noopener">https://sourceforge.net/p/log4cplus/wiki/Home/</a><br>
<br>
<sup>[8]</sup><a href="https://www.gamedev.net/articles/programming/general-and-gameplay-programming/c-custom-memory-allocation-r3010/" rel="noopener">https://www.gamedev.net/articles/programming/general-and-gameplay-programming/c-custom-memory-allocation-r3010/</a><br>
<br>
<sup>[9]</sup><a href="https://www.gamedev.net/articles/programming/general-and-gameplay-programming/c-custom-memory-allocation-r3010/" rel="noopener">https://github.com/mtrebi/memory-allocatorshttps://www.gamedev.net/articles/programming/general-and-gameplay-programming/c-custom-memory-allocation-r3010/</a><br>
<br>
<sup>[10]</sup><a href="http://en.cppreference.com/w/cpp/language/constant_initialization" rel="noopener">http://en.cppreference.com/w/cpp/language/constant_initialization</a><br>
<br>
<sup>[11]</sup><a href="https://en.wikipedia.org/wiki/Variadic_template" rel="noopener">https://en.wikipedia.org/wiki/Variadic_template</a><br>
<br>
<sup>[12]</sup><a href="http://gameprogrammingpatterns.com/object-pool.html" rel="noopener">http://gameprogrammingpatterns.com/object-pool.html</a><br>
<br>
<sup>[13]</sup><a href="http://en.cppreference.com/w/cpp/language/new" rel="noopener">http://en.cppreference.com/w/cpp/language/new</a><br>
<br>
<h2>Часть 2: Игра BountyHunter</h2><br>
Теперь я хочу показать вам, как на самом деле использовать архитектуру для создания на ней игр. Признаю, моя игра выглядит не очень сложной, но если вы решитесь использовать мою реализацию для создания собственной игры вместо большого и сложного игрового движка типа <a href="https://unity3d.com/" rel="noopener">Unity</a> или <a href="http://unrealengine.com/" rel="noopener">Unreal</a>, то можете упомянуть моё авторство. Чтобы продемонстрировать возможности моей ECS, мне достаточно было и такой игры. Если вы не поняли её правила, то вам поможет следующая картинка:<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/6c4fd38e8d700ce208a873299571770b.png" alt="image"></div><br>
<i>Рисунок 01: Цель и правила игры BountyHunter. Цель: каждый игрок стремится как можно быстрее пополнить собственные припасы. Правила: 1. Игра имеет ограничение по времени. По истечении времени игра завершается. 2. Касаясь добычи, сборщик подбирает её. 3. Сборщики могут переносить ограниченное количество добычи. Если предел достигнут, то сборщик больше не может собирать добычу, а при касании добычи она уничтожается. 4. Если сборщик касается своих или вражеских припасов, то вся собранная добыча сбрасывается в припасы и сборщик снова может собирать добычу. 5. При столкновении сборщиков они уничтожаются и через какое-то время возрождаются в точке своих припасов. Собранная добыча теряется. 6. Добыча появляется в случайной точке центральной части мира и существует в течение своего срока жизни, или пока не будет собрана. 7. Когда сборщик пересекает границы мира, то появляется с другого края экрана.</i><br>
<br>
Изображение слева выглядит знакомо, потому что это более абстрактная схема игры, которую вы видели в видео. Правила достаточно понятны и говорят сами за себя. Как видите, у нас есть множество типов сущностей, живущих в игровом мире. Вам наверно интересно, из чего на самом деле они состоят? Из компонентов, разумеется. Некоторые типы компонентов общие для всех сущностей, другие же уникальны для других. Посмотрите на рисунок ниже.<br>
<br>
<div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/db6486421d2282d555d5ac5af577aafc.png" alt="image"></div><br>
<i>Рисунок 02: Сущность и её компоненты.</i><br>
<br>
Посмотрев на этот рисунок, можно легко увидеть отношения между сущностями и их компонентами (на рисунке отражено не всё!). Все сущности игры имеют <em>Transform-Component</em>. Поскольку сущности игры должны быть расположены где-то в мире, у них есть transform, описывающий положение, поворот и масштаб сущностей. Это может быть единственный компонент, прикреплённый к сущности. Например, объект камеры требует больше компонентов, но ей не нужен <em>Material-Component</em>, потому что она никогда не будет видима игроку (что может быть неверно, если вы используете постэффекты). С другой стороны, объекты сущностей <em>Bounty</em> (добыча) и <em>Collector</em> (сборщик) должны быть видны, поэтому им для отображения необходим <em>Material-Component</em>. Также они могут сталкиваться с другими объектами игры, а потому к ним прикреплён <em>Collision-Component</em>, описывающий их физическую форму. К сущности <em>Bounty</em> прикреплён ещё один компонент — <em>Lifetime-Component</em>. Этот компонент определяет оставшийся срок жизни объекта <em>Bounty</em>, когда срок его жизни заканчивается, то добыча уничтожается.<br>
<br>
Итак, что же дальше? Создав все эти различные сущности с их собственными наборами компонентов, мы не доделали саму игру. Нам также нужен кто-то, знающий, как управлять каждым из них. Разумеется, я говорю о системах. Системы — это отличная вещь, их можно использовать для разделения всей логики игры на более мелкие элементы. Каждый элемент, работает с собственным аспектом игры. У нас может быть, или даже должна быть система <em>Input-System</em>, обрабатывающая все вводимые игроком данные. <em>Render-System</em>, переносящая все формы и цвета на экран. <em>Respawn-System</em> для возрождения мёртвых объектов игры. Ну, думаю, вы поняли идею. На рисунке ниже показана полная схема классов всех конкретных типов сущностей, компонентов и систем в <em>BountyHunter</em>.<br>
<br>
<a href="https://www.gamedev.net/applications/core/interface/imageproxy/ximageproxy.php,qimg=https,3A,_,_tsprojectsblog.files.wordpress.com,_2017,_11,_classdiagram1.png,qw=2000,akey=e046a10819209b63a1573c7254d4a2ce3adb0cd3c5b033c8d8c0a1c06708cf6f.pagespeed.ic.Eb5zg3PXyK.png"><div style="text-align:center;"><img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/e588183eb0e95a0225ca34a957f16480.png" alt="image"></div></a><br>
<i>Рисунок 03: Схема классов ECS BountyHunter (нажмите на изображение, чтобы увеличить его).</i><br>
<br>
Теперь у нас есть сущности, компоненты и система (ECS), но нам не хватает… событий! Чтобы системы и сущности могли обмениваться данными, я создал коллекцию из 38 событий:<br>
<br>
<pre>GameInitializedEvent GameRestartedEvent GameStartedEvent 
GamePausedEvent GameResumedEvent GameoverEvent GameQuitEvent 
PauseGameEvent ResumeGameEvent RestartGameEvent QuitGameEvent 
LeftButtonDownEvent LeftButtonUpEvent LeftButtonPressedEvent 
RightButtonDownEvent RightButtonUpEvent RightButtonPressedEvent
KeyDownEvent KeyUpEvent KeyPressedEvent ToggleFullscreenEvent
EnterFullscreenModeEvent StashFull EnterWindowModeEvent 
GameObjectCreated GameObjectDestroyed PlayerLeft GameObjectSpawned
GameObjectKilled CameraCreated, CameraDestroyed ToggleDebugDrawEvent
WindowMinimizedEvent WindowRestoredEvent WindowResizedEvent 
PlayerJoined CollisionBeginEvent CollisionEndEvent</pre><br>
И есть ещё многое, что мне потребовалось для реализации <em>BountyHunter</em>:<br>
<br>
<ul>
<li><strong>общий фреймворк приложения</strong> — <a href="https://www.libsdl.org/index.php" rel="noopener">SDL2</a> для получения ввода игрока и настройки основного окна приложения.</li>
<li><strong>графика</strong> — я использовал собственный рендерер OpenGL, чтобы можно было выполнять рендеринг в это окно приложения.</li>
<li><strong>математика</strong> — для линейной алгебры я использовал <a href="https://glm.g-truc.net/0.9.8/index.html" rel="noopener">glm</a>.</li>
<li><b>распознавание коллизий</b> — для неё я использовал физику <a href="http://box2d.org/" rel="noopener">box2d</a>.</li>
<li><strong>Конечный автомат</strong> — использовался для простого ИИ и состояний игры.</li>
</ul><br>
Разумеется, я не буду рассматривать все эти механики, потому что они заслуживают собственной статьи, которую я возможно напишу позже. Но если вы всё равно хотите о них узнать, то я не буду вам мешать и дам эту <a href="https://github.com/tobias-stein/EntityComponentSystem/tree/master/BountyHunterDemo" rel="noopener">ссылку</a>. Изучив все упомянутые мной характеристики, вы можете решить, что это может стать хорошим началом для вашего собственного игрового движка. В моём списке есть ещё несколько пунктов, которые я на самом деле не реализовал, просто потому, что хотел завершить прототип.<br>
<br>
<ul>
<li><strong>Редактор</strong> для управления сущностями, компонентами, системами и другим</li>
<li><strong>Сохранение игры</strong> — сохранение сущностей и их компонентов в базу данных с помощью какой-нибудь библиотеки ORM (например, <a href="https://www.codesynthesis.com/products/odb/" rel="noopener">codesynthesis</a>)</li>
<li><strong>Воспроизведение реплеев</strong> — запись событий во время выполнения и их воспроизведение в дальнейшем</li>
<li><strong>GUI</strong> — использование GUI-фреймворка (например, <a href="https://github.com/libRocket/libRocket" rel="noopener">librocket</a>) для создания интерактивного игрового меню</li>
<li><strong>Диспетчер ресурсов</strong> — синхронная и асинхронная загрузка ресурсов (текстур, шрифтов, моделей и т.д.) с помощью собственного диспетчера ресурсов</li>
<li><strong>Работа по сети</strong> — передача событий по сети и настройка многопользовательского режима</li>
</ul><br>
Я оставлю эти пункты как задание для вас, чтобы можно было доказать, насколько вы крутой программист.<br>
<br>
Также мне нужно показать вам код, демонстрирующий использование моей ECS. Помните игровую сущность <em>Bounty</em>? Добыча — это мелкие жёлтые, крупные красные и промежуточные квадраты, случайно создаваемые в центре мира. Ниже показан фрагмент кода определения класса сущности <em>Bounty</em>.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Bounty.h</span></span>

<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bounty</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject&lt;Bounty&gt;
{
<span class="hljs-keyword"><span class="hljs-keyword">private</span></span>:

    <span class="hljs-comment"><span class="hljs-comment">// кэшируем компоненты</span></span>
    TransformComponent*   m_ThisTransform;
    RigidbodyComponent*   m_ThisRigidbody;
    CollisionComponent2D* m_ThisCollision;
    MaterialComponent*    m_ThisMaterial;
    LifetimeComponent*    m_ThisLifetime;

   <span class="hljs-comment"><span class="hljs-comment">// свойство класса bounty</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>                 m_Value;

<span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:

    Bounty(GameObjectId spawnId);
    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~Bounty();

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override</span></span>;
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDisable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override</span></span>;

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetBounty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_Value; }

    <span class="hljs-comment"><span class="hljs-comment">// вызывает OnEnable, задаёт случайно выбираемое значение добычи</span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShuffleBounty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>;
};</code></pre><br>
Код довольно прост и понятен. Я создал новую игровую сущность, полученную из <em>GameObject&lt;<strong>T</strong>&gt;</em> (который получен из <em>ECS::Entity&lt;<strong>T</strong>&gt;)</em> с самим классом (<em>Bounty</em>) в качестве <strong>T</strong>. Теперь ECS известен этот конкретный тип сущности и будет создан уникальный идентификатор (статического) типа. Также мы получаем доступ к удобным методам <em>AddComponent&lt;<strong>U</strong>&gt;</em>, <em>GetComponent&lt;<strong>U</strong>&gt;</em>, <em>RemoveComponent&lt;<strong>U</strong>&gt;</em>. Кроме компонентов, которые я скоро покажу, есть ещё одно свойство — значение добычи. Я не помню точно, почему я не выделил это свойство в отдельный компонент, например, в <em>BountyComponent</em>, потому что так было бы правильно. Вместо этого я сделал свойство значения добычи членом класса <em>Bounty</em>, посыпаю голову пеплом. Но на самом деле это только показывает огромную гибкость этого шаблона, не так ли? Точнее, его компонентов…<br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Bounty.cpp</span></span>
Bounty::Bounty(GameObjectId spawnId)
{
    Shape shape = ShapeGenerator::CreateShape&lt;QuadShape&gt;();
    AddComponent&lt;ShapeComponent&gt;(shape);
    AddComponent&lt;RespawnComponent&gt;(BOUNTY_RESPAWNTIME, spawnId, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);

    <span class="hljs-comment"><span class="hljs-comment">// кэшируем эти компоненты</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisTransform = GetComponent&lt;TransformComponent&gt;();
    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisMaterial  = AddComponent&lt;MaterialComponent&gt;(MaterialGenerator::CreateMaterial&lt;defaultmaterial&gt;());
    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisRigidbody = AddComponent&lt;RigidbodyComponent&gt;(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0001f</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisCollision = AddComponent&lt;CollisionComponent2d&gt;(shape, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisTransform-&gt;AsTransform()-&gt;GetScale(), CollisionCategory::Bounty_Category, CollisionMask::Bounty_Collision);
    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_ThisLifetime  = AddComponent&lt;LifetimeComponent&gt;(BOUNTY_MIN_LIFETIME, BOUNTY_MAX_LIFETIME);
}
<span class="hljs-comment"><span class="hljs-comment">// другие реализации ...</span></span></code></pre><br>
Я использовал конструктор, чтобы присоединить все компоненты, необходимые сущности <em>Bounty</em>. Заметьте, что при таком подходе создаётся заготовка объекта и он не гибок, то есть вы всегда получаете объект <em>Bounty</em> с теми же присоединёнными к нему компонентами. Хотя это достаточно хорошее решение для моей игры, для более сложной оно может оказаться ошибочным. В таком случае нужно реализовать шаблон «фабрика», создающий изменяемые объекты сущностей.<br>
<br>
Как видно из кода выше, к сущности <em>Bounty</em> прикреплено довольно мало компонентов. У нас есть <em>ShapeComponent</em> и <em>MaterialComponent</em> для визуального отображения. <em>RigidbodyComponent</em> и <em>CollisionComponent2D</em> для физического поведения и реакции на коллизии. <em>RespawnComponent</em>, чтобы у <em>Bounty</em> была возможность возродиться после смерти. Последний по порядку, но не по значимости — <em>LifetimeComponent</em>, привязывающий существование сущности к определённому промежутку времени. <em>TransformComponent</em> автоматически привязывается к любой сущности, полученной из <em>GameObject&lt;<strong>T</strong>&gt;</em>. Вот и всё. Мы только добавили в игру новую сущность.<br>
<br>
Теперь вы возможно хотите узнать, как использовать все эти компоненты. Позвольте мне показать два примера. Первый — это <em><a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/BountyHunterDemo/RigidbodyComponent.h" rel="noopener">RigidbodyComponent</a></em>. Этот компонент содержит информацию о физических характеристиках, например, о трении, плотности и линейном затухании. Более того, он используется в качестве класса-адаптера, применяемого для встраивания в игру физики box2d. <em>RigidbodyComponent</em> довольно важен, потому что используется для синхронизации transform физически симулируемого тела (которым владеет box2d) и <em>TransformComponent</em> сущности (которым владеет игра). Этот процесс синхронизации выполняется <em>PhysicsSystem</em>.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// PhysicsEngine.h</span></span>

<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhysicsSystem</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ECS::System&lt;PhysicsSystem&gt;, <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> b2ContactListener
{
<span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:
PhysicsSystem();
    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~PhysicsSystem();

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dt)</span></span></span><span class="hljs-function"> override</span></span>;
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dt)</span></span></span><span class="hljs-function"> override</span></span>;
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PostUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dt)</span></span></span><span class="hljs-function"> override</span></span>;

    <span class="hljs-comment"><span class="hljs-comment">// Подключение механизма обработки событий физики box2d для сообщения о коллизиях</span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b2Contact* contact)</span></span></span><span class="hljs-function"> override</span></span>;
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b2Contact* contact)</span></span></span><span class="hljs-function"> override</span></span>;
}; <span class="hljs-comment"><span class="hljs-comment">// class PhysicsSystem</span></span></code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// PhysicsEngine.cpp</span></span>

<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> PhysicsSystem::PreUpdate(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dt)
{
    <span class="hljs-comment"><span class="hljs-comment">// Синхронизация преобразований физического твёрдого тела и TransformComponent</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> RB = ECS::ECS_Engine-&gt;GetComponentManager()-&gt;begin&lt;RigidbodyComponent&gt;(); RB != ECS::ECS_Engine-&gt;GetComponentManager()-&gt;end&lt;RigidbodyComponent&gt;(); ++RB)
    {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((RB-&gt;m_Box2DBody-&gt;IsAwake() == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) &amp;&amp; (RB-&gt;m_Box2DBody-&gt;IsActive() == <span class="hljs-literal"><span class="hljs-literal">true</span></span>))
        {
            TransformComponent* TFC = ECS::ECS_Engine-&gt;GetComponentManager()-&gt;GetComponent&lt;TransformComponent&gt;(RB-&gt;GetOwner());
            <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b2Vec2&amp; pos = RB-&gt;m_Box2DBody-&gt;GetPosition();
            <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> rot = RB-&gt;m_Box2DBody-&gt;GetAngle();

            TFC-&gt;SetTransform(glm::translate(glm::mat4(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>), Position(pos.x, pos.y, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>)) * glm::yawPitchRoll(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, rot) * glm::scale(TFC-&gt;AsTransform()-&gt;GetScale()));
        }
    }
}

<span class="hljs-comment"><span class="hljs-comment">// другие реализации ...</span></span></code></pre><br>
Из представленной выше реализации можно заметить три различные функции обновления. При обновлении систем первыми вызываются все методы <em>PreUpdate</em> всех систем, затем <em>Update</em>, и после них методы <em>PostUpdate</em>. Поскольку <em>PhysicsSystem</em> вызывается до всех <em>TransformComponent</em>, касающихся системы, представленный выше код обеспечивает синхронизацию transform. Здесь можно также увидеть в действии <em>ComponentIterator</em>. Вместо запрашивания каждой сущности в мире о том, имеет ли она <em>RigidbodyComponent</em>, мы запрашиваем <em>ComponentManager</em> предоставить нам <em>ComponentIterator</em> для типа <em>RigidbodyComponent</em>. Получив <em>RigidbodyComponent</em>, мы легко можем получить идентификатор сущности и ещё раз попросить <em>ComponentManager</em> дать нам и <em>TransformComponent</em> для этого идентификатора.<br>
<br>
Как я и обещал, давайте рассмотрим и второй пример. <a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/BountyHunterDemo/RespawnComponent.h" rel="noopener"><em>RespawnComponent</em></a> используется для сущностей, которые должны возрождаться после смерти. Этот компонент предоставляет пять свойств, которые можно использовать для настройки поведения возрождения сущности. Можно выбрать автоматическое возрождение сущности после смерти, задать время, через которое она будет возрождена, а также позицию и ориентацию возрождения. Сама логика возрождения реализована в <a href="https://github.com/tobias-stein/EntityComponentSystem/blob/master/BountyHunterDemo/RespawnSystem.h"><em>RespawnSystem</em></a>.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// RespawnSystem.h</span></span>
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RespawnSystem</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ECS::System&lt;RespawnSystem&gt;, <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> ECS::Event::IEventListener
{
<span class="hljs-keyword"><span class="hljs-keyword">private</span></span>:

    <span class="hljs-comment"><span class="hljs-comment">// ... всё остальное</span></span>
    Spawns       m_Spawns;
    RespawnQueue m_RespawnQueue;

    <span class="hljs-comment"><span class="hljs-comment">// Механизм обработки событий</span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnGameObjectKilled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> GameObjectKilled* event)</span></span></span></span>;

<span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:

    RespawnSystem();
    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~RespawnSystem();

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dt)</span></span></span><span class="hljs-function"> override</span></span>;

    <span class="hljs-comment"><span class="hljs-comment">// другое ...</span></span>
}; <span class="hljs-comment"><span class="hljs-comment">// class RespawnSystem</span></span></code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// RespawnSystem.cpp</span></span>
<span class="hljs-comment"><span class="hljs-comment">// примечание: это только псевдокод!</span></span>

voidRespawnSystem::OnGameObjectKilled(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GameObjectKilled * event)
{
    <span class="hljs-comment"><span class="hljs-comment">// проверяем, имеет ли сущность возможность возрождения</span></span>
    RespawnComponent* entityRespawnComponent = ECS::ECS_Engine-&gt;GetComponentManager()-&gt;GetComponent&lt;RespawnComponent&gt;(event-&gt;m_EntityID);

    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(entityRespawnComponent == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> || (entityRespawnComponent-&gt;IsActive() == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) || (entityRespawnComponent-&gt;m_AutoRespawn == <span class="hljs-literal"><span class="hljs-literal">false</span></span>))
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;

    AddToRespawnQeueue(event-&gt;m_EntityID, entityRespawnComponent);
}

<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> RespawnSystem::Update(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dt)
{
    foreach(spawnable in <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_RespawnQueue)
    {
        spawnable.m_RemainingDeathTime -= dt;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(spawnable.m_RemainingDeathTime &lt;= <span class="hljs-number"><span class="hljs-number">0.0f</span></span>)
        {
            DoSpawn(spawnable);
            RemoveFromSpawnQueue(spawnable);
        }
    }
}</code></pre><br>
Представленный выше код неполон, но даёт представление о важных строках кода. <em>RespawnSystem</em> содержит и обновляет очередь <em>EntityId</em> вместе с их <em>RespawnComponent</em>. Новые сущности ставятся в очередь, когда системы получают событие <em>GameObjectKilled</em>. Система проверяет, обладает ли убитая сущность возможностью возрождения, то есть присоединён ли к ней <em>RespawnComponent</em>. Если да, то сущность ставится в очередь на возрождение, в противном случае игнорируется. В методе обновления <em>RespawnSystem</em>, который вызывается каждый кадр, система уменьшает изначальное время возрождения <em>RespawnComponent</em> поставленных в очередь сущностей. Если время возрождения снижается до нуля, то сущность возрождается и удаляется из очереди возрождения.<br>
<br>
Знаю, статья была довольно короткой. но надеюсь, она дала вам примерное представление о том, как всё работает в мире ECS. Прежде чем закончить пост, я хочу поделиться с вами собственным опытом. Работа с ECS — это огромное удовольствие. В игру удивительно просто добавлять новые возможности даже с помощью сторонних библиотек Я просто добавил новые компоненты и системы, которые связывают новые возможности с игрой, при этом у меня никогда не было чувства, что я зашёл в тупик. Разделение всей игровой логики на несколько систем интуитивно понятно и не вызывает никаких сложностей при работе с ECS. Код выглядит гораздо понятнее и становится удобнее в поддержке, потому что мы избавились от всех «спагетти-зависимостей» указателей. Event sourcing — очень мощная и полезная техника обмена данными между системами/сущностями, но это обоюдоострое лезвие, и может со временем вызвать проблемы. Я говорю об условиях вызова событий. Если вы когда-нибудь работали с редактором Unity или Unreal Engine, то будете довольны реализации такого редактора. Эти редакторы сильно увеличивают продуктивность, потому что на создание новых объектов ECS уходит гораздо меньше времени, чем на написание всех этих строчек кода вручную. Но когда вы создадите мощный фундамент из объектов сущностей, компонентов, систем и событий, то их соединение и создание на их основе чего-то качественного будет простой задачей.</div>
      
      
<script class="js-mediator-script">!function(e){function t(t,n){if(!(n in e)){for(var r,a=e.document,i=a.scripts,o=i.length;o--;)if(-1!==i[o].src.indexOf(t)){r=i[o];break}if(!r){r=a.createElement("script"),r.type="text/javascript",r.async=!0,r.defer=!0,r.src=t,r.charset="UTF-8";var d=function(){var e=a.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)};"[object Opera]"==e.opera?a.addEventListener?a.addEventListener("DOMContentLoaded",d,!1):e.attachEvent("onload",d):d()}}}t("//mediator.mail.ru/script/2820404/","_mediator")}(window);</script>
    </div>

    

    <dl class="post__tags">
      <dt class="post__tags-label">Теги:</dt>
      <dd class="post__tags-list">    <ul class="inline-list inline-list_fav-tags js-post-tags">
        <li class="inline-list__item inline-list__item_tag"><a href="https://habr.com/ru/search/?q=%5B%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D1%8B%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%5D&amp;target_type=posts" rel="tag" class="inline-list__item-link post__tag  ">шаблоны проектирования</a></li>
        <li class="inline-list__item inline-list__item_tag"><a href="https://habr.com/ru/search/?q=%5Bentity%20component%20system%5D&amp;target_type=posts" rel="tag" class="inline-list__item-link post__tag  ">entity component system</a></li>
        <li class="inline-list__item inline-list__item_tag"><a href="https://habr.com/ru/search/?q=%5B%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B8%D0%B3%D1%80%5D&amp;target_type=posts" rel="tag" class="inline-list__item-link post__tag  ">программирование игр</a></li>
        <li class="inline-list__item inline-list__item_tag"><a href="https://habr.com/ru/search/?q=%5B%D1%81%D1%83%D1%89%D0%BD%D0%BE%D1%81%D1%82%D1%8C%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0%5D&amp;target_type=posts" rel="tag" class="inline-list__item-link post__tag  ">сущность компонент система</a></li>
    </ul>
    <button type="button" class="btn btn_outline_grey btn_mini hidden js-fav-edit-link" data-type="2" data-id="343778" onclick="show_edit_tags(this)">Добавить метки</button>
</dd>
    </dl>
  </div>
</article>


      <form action="https://habr.com/json/favorites/" method="post" class="form form_bordered form_favorites-tags hidden" id="edit_tags_form">
  <input type="hidden" name="action" value="add">
  <input type="hidden" name="ti" value="0">
  <input type="hidden" name="tt" value="0">

  <button type="button" class="btn form__close-btn" onclick="closeForm(this)" title="Закрыть"><svg class="icon-svg icon-svg_navbar-close-search" width="31" height="32" viewBox="0 0 31 32" aria-hidden="true" version="1.1" role="img"><path d="M26.67 0L15.217 11.448 3.77 0 0 3.77l11.447 11.45L0 26.666l3.77 3.77L15.218 18.99l11.45 11.448 3.772-3.77-11.448-11.45L30.44 3.772z"></path></svg>
</button>

  <fieldset class="form__fieldset">
    <legend class="form__legend">Пометьте публикацию своими метками</legend>
    <input type="text" name="tags_string" class="form__text-field" autocomplete="off">
    <span class="form__desc">Метки лучше разделять запятой. Например: <i>программирование, алгоритмы</i></span>
  </fieldset>

  <div class="form__footer">
    <button type="submit" class="btn btn_x-large btn_outline_blue" disabled="">Сохранить</button>
  </div>
</form>

    </div>

    <div class="sidebar_right sidebar_content-area sticky_init">
        <!-- /235032688/HH/HH01_ATF_Poster -->
<div class="dfp-slot dfp-slot_top is_visible">
  <div class="dfp-slot__banner" id="div-gpt-hh-atf" data-google-query-id="CMOhxNXci-ICFQKbGAodxsgMMg">
    
  <div id="google_ads_iframe_/235032688/HH/HH01_ATF_Poster_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/235032688/HH/HH01_ATF_Poster_0" title="3rd party ad content" name="google_ads_iframe_/235032688/HH/HH01_ATF_Poster_0" width="300" height="600" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/saved_resource.html"></iframe></div></div>
  <div class="dfp-slot__placeholder">
  <span class="dfp-slot__placeholder-text">Хардкорная конфа по С++. Мы приглашаем только профи.<br><br><a href="https://u.tmtm.ru/JUG_confa_april2019_adblock" class="btn btn_large btn_blue" style="display:inline-flex!important;" target="_blank" rel=" noopener">Приходите</a></span>
</div>
<a href="https://tmtm.ru/services/advertising/" target="_blank" class="dfp-slot__label" rel=" noopener">Реклама</a>

</div>

        

  <div class="js-ad_sticky">
    <div class="default-block">
      <div class="default-block__header">
        <h3 class="default-block__header-title">Читают сейчас</h3>
      </div>

      <div class="default-block__content default-block__content_most-read" id="broadcast_most-read">
            <ul class="content-list content-list_most-read">
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450770/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;1&#39;); }">Авиакатастрофа в Шереметьево: исторические аналогии</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">19,3k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450770/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">160</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450878/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;2&#39;); }">Поймай меня, если сможешь</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">26,1k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450878/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">75</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/news/t/450900/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;3&#39;); }">Умелец растворил банковскую карту в ацетоне, чтобы сделать кольцо для бесконтактных платежей</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">22,3k</span>
                    </span>
                    <a href="https://habr.com/ru/news/t/450900/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">66</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450848/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;4&#39;); }">О жёлтом фосфоре и панической природе человека</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">34k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450848/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">90</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/company/itsumma/blog/450846/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;5&#39;); }">Чудеса упаковки от Microsoft: ядро Linux в Windows 10 и движок IE внутри Chromium Edge</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">38k</span>
                    </span>
                    <a href="https://habr.com/ru/company/itsumma/blog/450846/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">120</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/company/haulmont/blog/450914/" class="post-info__title" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;, &#39;6&#39;); }">Переговоры провалены: как Oracle убила Java EE</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">11,3k</span>
                    </span>
                    <a href="https://habr.com/ru/company/haulmont/blog/450914/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter post-info__meta-counter_small">34</span>
                    </a>
                  </div>
                </li>
            </ul>
      </div>
    </div>
  </div>

    </div>
  </section>

  <section class="column-wrapper column-wrapper_post-additionals">
    <div class="content_left">
      <div class="post-additionals">
          <ul class="post-stats post-stats_post js-user_" data-post-type="publish_editorial" id="infopanel_post_343778">
        <li class="post-stats__item post-stats__item_voting-wjt">
          <div class="voting-wjt voting-wjt_post js-post-vote" data-id="343778" data-type="2">
            <button type="button" class="btn voting-wjt__button " data-action="plus" onclick="posts_vote(this);" title="Голосовать могут только зарегистрированные пользователи " disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

            <span class="voting-wjt__counter voting-wjt__counter_positive  js-score" title="Общий рейтинг 15: ↑15 и ↓0">+15</span>

            <button type="button" class="btn voting-wjt__button " data-action="minus" onclick="posts_vote(this);" title="Голосовать могут только зарегистрированные пользователи " disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
          </div>
        </li>
    <li class="post-stats__item post-stats__item_bookmark">
      <button type="button" class="btn bookmark-btn bookmark-btn_post " data-post-type="publish_editorial" data-type="2" data-id="343778" data-action="add" title="Только зарегистрированные пользователи могут добавлять публикации в закладки" onclick="posts_add_to_favorite(this);" disabled="">
        <span class="btn_inner"><svg class="icon-svg_bookmark" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="bookmark__counter js-favs_count" title="Количество пользователей, добавивших публикацию в закладки">138</span></span>
      </button>
    </li>

    <li class="post-stats__item post-stats__item_views">
      <div class="post-stats__views" title="Количество просмотров">
        <svg class="icon-svg_views-count" width="21" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-stats__views-count">26,7k</span>
      </div>
    </li>

      <li class="post-stats__item post-stats__item_comments">
          <a href="https://habr.com/ru/post/343778/#comments" class="post-stats__comments-link" rel="nofollow">
            <svg class="icon-svg_post-comments" width="16" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-stats__comments-count" title="Читать комментарии">6</span>
          </a>
      </li>





  </ul>

            <form action="https://habr.com/conversations/PatientZero/" method="GET" class="form form_bordered form_admin-causes hidden" id="admin_causes">

    <input type="hidden" name="moderation" value="343778">

    <button type="button" class="btn form__close-btn" onclick="closeForm(this)"><svg class="icon-svg icon-svg_navbar-close-search" width="31" height="32" viewBox="0 0 31 32" aria-hidden="true" version="1.1" role="img"><path d="M26.67 0L15.217 11.448 3.77 0 0 3.77l11.447 11.45L0 26.666l3.77 3.77L15.218 18.99l11.45 11.448 3.772-3.77-11.448-11.45L30.44 3.772z"></path></svg>
</button>

    <fieldset class="form__fieldset form__fieldset_admin-causes">
      <legend class="form__legend">Выберите рекомендации для отправки автору:</legend>

      <div class="checkbox-group_columns">
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="1">
          <span class="checkbox__label">Указан только блог</span>
        </label>

        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="2">
          <span class="checkbox__label">Орфографические ошибки</span>
        </label>

        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="3">
          <span class="checkbox__label">Пунктуационные ошибки</span>
        </label>

        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="4">
          <span class="checkbox__label">Отступы</span>
        </label>

        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="5">
          <span class="checkbox__label">Текст-простыня</span>
        </label>

        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="6">
          <span class="checkbox__label">Короткие предложения</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="7">
          <span class="checkbox__label">Смайлики</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="8">
          <span class="checkbox__label">Много форматирования</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="9">
          <span class="checkbox__label">Картинки</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="10">
          <span class="checkbox__label">Ссылки</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="11">
          <span class="checkbox__label">Оформление кода</span>
        </label>
        <label class="checkbox checkbox_custom checkbox_recommendation-form">
          <input type="checkbox" class="form__input form__input_checkbox" name="id[]" value="12">
          <span class="checkbox__label">Рекламный характер</span>
        </label>
      </div>
    </fieldset>

    <div class="form__footer">
      <button type="submit" class="btn btn_x-large btn_outline_blue" disabled="">Отправить</button>
    </div>
  </form>

          <form action="https://habr.com/json/complaints/add/" class="form form_bordered form_abuse hidden" method="post" id="abuse_form">
  <input type="hidden" name="tt" value="2">
  <input type="hidden" name="ti" value="343778">

  <button type="button" class="btn form__close-btn" onclick="closeForm(this)"><svg class="icon-svg icon-svg_navbar-close-search" width="31" height="32" viewBox="0 0 31 32" aria-hidden="true" version="1.1" role="img"><path d="M26.67 0L15.217 11.448 3.77 0 0 3.77l11.447 11.45L0 26.666l3.77 3.77L15.218 18.99l11.45 11.448 3.772-3.77-11.448-11.45L30.44 3.772z"></path></svg>
</button>

  <fieldset class="form__fieldset">
    <legend class="form__legend">Нарушение</legend>
    <input type="text" name="text" class="form__text-field">
    <span class="form__desc">Опишите суть нарушения</span>
  </fieldset>

  <div class="form__footer">
    <button type="submit" class="btn btn_x-large btn_outline_blue" disabled="">Отправить</button>
  </div>
</form>


          <div class="author-panel author-panel_user">
            <div class="user-info">
    <div class="user-info__stats">
  <div class="media-obj media-obj_user-info">
    <a href="https://habr.com/ru/users/PatientZero/" class="media-obj__image" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;author_info_top&#39;, &#39;profile&#39;, &#39;PatientZero&#39;);}">
        <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/8de9c534a18a6cb8693270a2b528d4c0.png" width="48" height="48" class="media-obj__image-pic media-obj__image-pic_user">
    </a>

    <div class="media-obj__body media-obj__body_user-info">
          <a href="https://habr.com/ru/info/help/karma/" class="user-info__stats-item stacked-counter" title="965 голосов">
            <div class="stacked-counter__value stacked-counter__value_green ">895,7</div>
            <div class="stacked-counter__label">Карма</div>
          </a>

        <a href="https://habr.com/ru/info/help/karma/#rating" class="user-info__stats-item stacked-counter stacked-counter_rating" title="Рейтинг пользователя">
          <div class="stacked-counter__value stacked-counter__value_magenta">2292,1</div>
          <div class="stacked-counter__label">Рейтинг</div>
        </a>

        <a href="https://habr.com/ru/users/PatientZero/subscription/followers/" class="user-info__stats-item stacked-counter stacked-counter_subscribers" title="Количество подписчиков">
          <div class="stacked-counter__value stacked-counter__value_blue">1438</div>
          <div class="stacked-counter__label">Подписчики</div>
        </a>
    </div>
  </div>

</div>


  <div class="user-info__about">
    <div class="user-info__links">
        <a href="https://habr.com/users/PatientZero/" class="user-info__nickname user-info__nickname_doggy" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;author_info_top&#39;, &#39;profile&#39;, &#39;PatientZero&#39;);}">PatientZero</a>
        
    </div>

      <div class="user-info__specialization">Переводчик-фрилансер</div>
  </div>

</div>

          </div>
            <div class="post-donate">
  <span class="post-donate__title">Поддержать автора</span>
  <button id="post-donate-button" class="btn_outline_blue btn btn_x-large js-show-donate">
    Отправить деньги
  </button>
</div>

<div class="overlay hidden" id="js-donate">
  <div class="popup">
    <div class="popup__head popup__head_lang-settings">
      <span class="popup__head-title js-popup_title" data-section="1">Платежная система</span>
      <button type="button" class="btn btn_small btn_popup-close js-hide-donate">
        <svg class="icon-svg" width="12" height="12">
          <use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#close"></use>
        </svg>
      </button>
    </div>
    <div class="popup__body js-donate-popup_body">
        <a class="js-donate-popup_link" href="https://money.yandex.ru/to/410013829899665" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;donation&#39;, &#39;pay_sender&#39;, &#39;%guest%&#39;); ga(&#39;send&#39;, &#39;event&#39;, &#39;donation&#39;, &#39;pay_receiver&#39;, &#39;PatientZero&#39;); }" rel=" noopener">Яндекс.Деньги</a>
        <a class="js-donate-popup_link" href="https://www.paypal.me/vadimivshin" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;donation&#39;, &#39;pay_sender&#39;, &#39;%guest%&#39;); ga(&#39;send&#39;, &#39;event&#39;, &#39;donation&#39;, &#39;pay_receiver&#39;, &#39;PatientZero&#39;); }" rel=" noopener">PayPal.Me</a>
    </div>
  </div>
</div>

          <div class="post-share">
  <span class="post-share__title">Поделиться публикацией</span>
  <ul class="post-share__buttons social-icons">
    <li class="social-icons__item social-icons__item_post">
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://habr.com/ru/post/343778/" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_facebook" title="Опубликовать ссылку в Facebook" onclick="window.open(this.href, &#39;Опубликовать ссылку в Facebook&#39;, &#39;width=640,height=436,toolbar=0,status=0&#39;); return false">
        <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M14.889 8.608h-1.65c-.195 0-.413.257-.413.6v1.192h2.063v1.698h-2.063v5.102h-1.948v-5.102h-1.766v-1.698h1.766v-1c0-1.434.995-2.6 2.361-2.6h1.65v1.808z"></path></svg>
      </a>
    </li>
    <li class="social-icons__item social-icons__item_post">
      <a href="https://twitter.com/intent/tweet?text=%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD+%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F+Entity-Component-System+%E2%80%94+%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F+%D0%B8+%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80+%D0%B8%D0%B3%D1%80%D1%8B+https://habr.com/p/343778/+via+%40habr_com" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_twitter" title="Опубликовать ссылку в Twitter" onclick="window.open(this.href, &#39;Опубликовать ссылку в Twitter&#39;, &#39;width=800,height=300,resizable=yes,toolbar=0,status=0&#39;); return false">
        <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M17.414 8.642c-.398.177-.826.296-1.276.35.459-.275.811-.71.977-1.229-.43.254-.905.439-1.41.539-.405-.432-.982-.702-1.621-.702-1.227 0-2.222.994-2.222 2.222 0 .174.019.344.058.506-1.846-.093-3.484-.978-4.579-2.322-.191.328-.301.71-.301 1.117 0 .77.392 1.45.988 1.849-.363-.011-.706-.111-1.006-.278v.028c0 1.077.766 1.974 1.782 2.178-.187.051-.383.078-.586.078-.143 0-.282-.014-.418-.04.282.882 1.103 1.525 2.075 1.542-.76.596-1.718.951-2.759.951-.179 0-.356-.01-.53-.031.983.63 2.15.998 3.406.998 4.086 0 6.321-3.386 6.321-6.321l-.006-.287c.433-.314.81-.705 1.107-1.15z"></path></svg>
      </a>
    </li>
    <li class="social-icons__item social-icons__item_post">
      <a href="https://vk.com/share.php?url=https://habr.com/ru/post/343778/" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_vkontakte" title="Опубликовать ссылку во ВКонтакте" onclick="window.open(this.href, &#39;Опубликовать ссылку во ВКонтакте&#39;, &#39;width=800,height=300,toolbar=0,status=0&#39;); return false">
        <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M16.066 11.93s1.62-2.286 1.782-3.037c.054-.268-.064-.418-.343-.418h-1.406c-.322 0-.44.139-.537.343 0 0-.76 1.619-1.685 2.64-.297.33-.448.429-.612.429-.132 0-.193-.11-.193-.408v-2.607c0-.365-.043-.472-.343-.472h-2.254c-.172 0-.279.1-.279.236 0 .343.526.421.526 1.352v1.921c0 .386-.022.537-.204.537-.483 0-1.631-1.663-2.274-3.552-.129-.386-.268-.494-.633-.494h-1.406c-.204 0-.354.139-.354.343 0 .375.44 2.114 2.167 4.442 1.159 1.566 2.683 2.414 4.056 2.414.838 0 1.041-.139 1.041-.494v-1.202c0-.301.118-.429.29-.429.193 0 .534.062 1.33.848.945.901 1.01 1.276 1.525 1.276h1.578c.161 0 .311-.075.311-.343 0-.354-.462-.987-1.17-1.738-.29-.386-.762-.805-.912-.998-.215-.226-.151-.354-.001-.59z"></path></svg>
      </a>
    </li>
    <li class="social-icons__item social-icons__item_post">
      <a href="https://t.me/share/url?url=https://habr.com/ru/post/343778/&amp;title=%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20Entity-Component-System%20%E2%80%94%20%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B8%20%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%20%D0%B8%D0%B3%D1%80%D1%8B" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_telegram" title="Поделиться ссылкой в Telegram" onclick="window.open(this.href, &#39;Поделиться ссылкой в Telegram&#39;, &#39;width=800,height=300,toolbar=0,status=0&#39;); return false">
        <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M17.17 7.621l-10.498 3.699c-.169.059-.206.205-.006.286l2.257.904 1.338.536 6.531-4.796s.189.057.125.126l-4.68 5.062-.27.299.356.192 2.962 1.594c.173.093.397.016.447-.199.058-.254 1.691-7.29 1.728-7.447.047-.204-.087-.328-.291-.256zm-6.922 8.637c0 .147.082.188.197.084l1.694-1.522-1.891-.978v2.416z"></path></svg>
      </a>
    </li>
    <li class="social-icons__item social-icons__item_post">
      <a href="https://getpocket.com/edit?url=https://habr.com/ru/post/343778/&amp;title=%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20Entity-Component-System%20%E2%80%94%20%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B8%20%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%20%D0%B8%D0%B3%D1%80%D1%8B" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_pocket" title="Добавить ссылку в Pocket" target="_blank" rel=" noopener">
      </a>
    </li>
  </ul>
</div>

      </div>
        

    <div class="default-block default-block_content">
      <div class="default-block__header default-block__header_large">
        <h2 class="default-block__header-title default-block__header-title_large">Похожие публикации</h2>
      </div>
      <div class="default-block__content">

        <ul class="content-list">
            <li class="content-list__item content-list__item_devided post-info">
              <span class="post-info__date">25 февраля 2016 в 23:39</span>
                <h3 class="post-info__title post-info__title_large">
                  <a href="https://habr.com/ru/post/277989/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;similar_posts&#39;, &#39;common&#39;, &#39;1&#39;); }">
                    Шаблон проектирования View в языках с зависимыми типами
                  </a>
                </h3>

              <div class="post-info__meta">
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg>
                      <span class="post-info__meta-counter">+12</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">9,5k</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">55</span>
                </span>
                <a href="https://habr.com/ru/post/277989#comments" class="post-info__meta-item" rel="nofollow">
                  <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">0</span>
                </a>
              </div>
            </li>
            <li class="content-list__item content-list__item_devided post-info">
              <span class="post-info__date">6 февраля 2016 в 16:17</span>
                <h3 class="post-info__title post-info__title_large">
                  <a href="https://habr.com/ru/post/276699/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;similar_posts&#39;, &#39;common&#39;, &#39;2&#39;); }">
                    Опыт лекций по введению в шаблоны проектирования
                  </a>
                </h3>

              <div class="post-info__meta">
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg>
                      <span class="post-info__meta-counter">+16</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">40,8k</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">220</span>
                </span>
                <a href="https://habr.com/ru/post/276699#comments" class="post-info__meta-item" rel="nofollow">
                  <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">80</span>
                </a>
              </div>
            </li>
            <li class="content-list__item content-list__item_devided post-info">
              <span class="post-info__date">12 января 2016 в 15:28</span>
                <h3 class="post-info__title post-info__title_large">
                  <a href="https://habr.com/ru/post/274941/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;similar_posts&#39;, &#39;common&#39;, &#39;3&#39;); }">
                    Еще немного об ошибках проектирования АСУ ТП и программирования ПЛК
                  </a>
                </h3>

              <div class="post-info__meta">
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg>
                      <span class="post-info__meta-counter">+19</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">15,6k</span>
                </span>
                <span class="post-info__meta-item">
                  <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">92</span>
                </span>
                <a href="https://habr.com/ru/post/274941#comments" class="post-info__meta-item" rel="nofollow">
                  <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">32</span>
                </a>
              </div>
            </li>
        </ul>

      </div>
    </div>

      <div class="default-block_content">
          

  <div class="promo-block promo-block_vacancies">
    <h2 class="promo-block__header">
      
      <a href="https://moikrug.ru/vacancies" target="_blank" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=block_name&amp;utm_campaign=vacancies_post" class="promo-block__title-link" rel="nofollow noopener">Вакансии</a>
      <a href="https://moikrug.ru/" target="_blank" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=block_logo&amp;utm_campaign=vacancies_post" class="promo-block__header-logo icon-svg_logo-mk" rel="nofollow noopener"><svg class="icon-svg" width="114" height="24" viewBox="0 0 114 24" aria-hidden="true" aria-labelledby="title" version="1.1" role="img"><path d="M9.383 7.685l-4.127-6.87h-5.258v17.614h4.931v-10.166l3.497 5.963h1.938l3.497-5.963v10.166h4.931v-17.614h-5.258zM27.726 5.47c-3.673 0-6.667 2.994-6.667 6.667s2.994 6.667 6.667 6.667c3.673 0 6.667-2.994 6.667-6.667.001-3.673-2.993-6.667-6.667-6.667zm0 8.908c-1.208 0-2.239-.982-2.239-2.239 0-1.208 1.032-2.239 2.239-2.239s2.239 1.032 2.239 2.239c.001 1.257-1.031 2.239-2.239 2.239zM40.835 11.735v-5.888h-4.68v12.582h4.68l4.152-5.888v5.888h4.68v-12.582h-4.68zM47.906 3.055l-1.359-2.617c-1.309.704-2.617.982-3.623.982s-2.341-.278-3.649-.982l-1.359 2.617c1.811.982 3.397 1.283 5.007 1.283s3.171-.303 4.983-1.283zM57.971 5.847v12.582h4.68v-12.582zM71.432 5.847h-4.931l-3.849 6.19 4.101 6.392h4.933l-4.353-6.392zM81.12 5.47c-1.283 0-2.667.806-3.246 2.013v-1.635h-4.68v17.713h4.68v-6.768c.578 1.208 1.962 2.013 3.246 2.013 3.673 0 5.662-2.994 5.662-6.667s-1.989-6.667-5.662-6.667zm-1.51 8.908c-.68 0-1.309-.327-1.736-.856v-2.792c.427-.503 1.057-.83 1.736-.83 1.208 0 2.239.982 2.239 2.239.001 1.207-1.031 2.239-2.239 2.239zM94.909 12.692l-2.666-6.845h-5.083l5.335 12.557-2.165 5.158h4.655l7.926-17.714h-5.082zM104.042 5.847v12.582h4.68v-8.304h5.561v-4.278z"></path></svg></a>
    </h2>

    <div class="promo-block__content">
      <ul class="content-list content-list_promo">
          <li class="content-list__item content-list__item_promo">
            <a href="https://moikrug.ru/vacancies/1000050367" class="promo-item" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancy&amp;utm_campaign=vacancies_post">
    <div class="promo-item__image-wrap">
      <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/medium_d6b8a6b8436b177eb348b1283e2583e1.jpg" alt="" class="promo-item__image">
    </div>
    <div class="promo-item__wrap">
      <div class="promo-item__title promo-item__title_hovered">Tech Lead PHP</div>
      <div class="promo-item__attrs">
        <span class="promo-item__attrs-item">Playneta</span>
        <span class="promo-item__attrs-item">Санкт-Петербург</span>
        
      </div>
    </div>

      <div class="promo-item__aside promo-item__aside_hovered">
        <div class="promo-item__amount promo-item__amount_rur">
            <span title="250000 rur">от 250000</span>
            <span title="300000 rur">до 300000</span>
        </div>
      </div>
  </a>

          </li>
          <li class="content-list__item content-list__item_promo">
            <a href="https://moikrug.ru/vacancies/1000043206" class="promo-item" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancy&amp;utm_campaign=vacancies_post">
    <div class="promo-item__image-wrap">
      <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/medium_9e2bb37023617d68dd35450b32ed22c1.png" alt="" class="promo-item__image">
    </div>
    <div class="promo-item__wrap">
      <div class="promo-item__title promo-item__title_hovered">Unity разработчик ( мобильный )</div>
      <div class="promo-item__attrs">
        <span class="promo-item__attrs-item">YOPS LTD</span>
        <span class="promo-item__attrs-item">Санкт-Петербург</span>
        <span class="promo-item__attrs-item">Возможна удаленная работа</span>
      </div>
    </div>

      <div class="promo-item__aside promo-item__aside_hovered">
        <div class="promo-item__amount promo-item__amount_rur">
            <span title="48000 rur">от 48000</span>
        </div>
      </div>
  </a>

          </li>
          <li class="content-list__item content-list__item_promo">
            <a href="https://moikrug.ru/vacancies/1000043604" class="promo-item" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancy&amp;utm_campaign=vacancies_post">
    <div class="promo-item__image-wrap">
      <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/medium_9e21a22176da29ad12971d46d270745d.png" alt="" class="promo-item__image">
    </div>
    <div class="promo-item__wrap">
      <div class="promo-item__title promo-item__title_hovered">2D Художник-колорист (gamedev)</div>
      <div class="promo-item__attrs">
        <span class="promo-item__attrs-item">ZAVOD Games</span>
        <span class="promo-item__attrs-item">Москва</span>
        
      </div>
    </div>

      <div class="promo-item__aside promo-item__aside_hovered">
        <div class="promo-item__amount promo-item__amount_rur">
            <span title="70000 rur">до 70000</span>
        </div>
      </div>
  </a>

          </li>
          <li class="content-list__item content-list__item_promo">
            <a href="https://moikrug.ru/vacancies/1000050241" class="promo-item" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancy&amp;utm_campaign=vacancies_post">
    <div class="promo-item__image-wrap">
      <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/medium_90e79a233f3324c126e2cb0582347c08.png" alt="" class="promo-item__image">
    </div>
    <div class="promo-item__wrap">
      <div class="promo-item__title promo-item__title_hovered">Мобильный Unity разработчик под AR проекты</div>
      <div class="promo-item__attrs">
        <span class="promo-item__attrs-item">BLACKVR</span>
        <span class="promo-item__attrs-item">Москва</span>
        <span class="promo-item__attrs-item">Возможна удаленная работа</span>
      </div>
    </div>

      <div class="promo-item__aside promo-item__aside_hovered">
        <div class="promo-item__amount promo-item__amount_rur">
            <span title="90000 rur">от 90000</span>
        </div>
      </div>
  </a>

          </li>
          <li class="content-list__item content-list__item_promo">
            <a href="https://moikrug.ru/vacancies/1000050530" class="promo-item" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancy&amp;utm_campaign=vacancies_post">
    <div class="promo-item__image-wrap">
      <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/medium_61332f5920234d06bc281c5896604a4c.png" alt="" class="promo-item__image">
    </div>
    <div class="promo-item__wrap">
      <div class="promo-item__title promo-item__title_hovered">Ведущий Unity программист / Senior Unity Developer</div>
      <div class="promo-item__attrs">
        <span class="promo-item__attrs-item">Cubic Games</span>
        
        <span class="promo-item__attrs-item">Возможна удаленная работа</span>
      </div>
    </div>

      <div class="promo-item__aside promo-item__aside_hovered">
        <div class="promo-item__amount promo-item__amount_eur">
            <span title="2000 eur">от 2000</span>
            <span title="4000 eur">до 4000</span>
        </div>
      </div>
  </a>

          </li>
      </ul>
    </div>

    <div class="promo-block__footer">
      <a href="https://moikrug.ru/vacancies/" data-utm="?utm_source=tm_habrahabr&amp;utm_medium=tm_block&amp;utm_content=vacancies_all&amp;utm_campaign=vacancies_post" class="promo-block__footer-link promo-block__footer-link_selected" target="_blank" rel="nofollow noopener">Все вакансии</a>

      <script type="text/javascript" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/saved_resource(1)"></script>
    </div>
  </div>


      </div>
    </div>
    <div class="sidebar_right">
    </div>
  </section>

<section class="column-wrapper column-wrapper_comments js-comments-wrapper">
  <div class="content_left">
        <div class="comments-section" id="comments">
    <header class="comments-section__head">
      <h2 class="comments-section__head-title">
        Комментарии
        <span class="comments-section__head-counter" id="comments_count">
          6
        </span>
      </h2>
      
    </header>
    
    

    <ul class="content-list content-list_comments" id="comments-list">
        <li class="content-list__item content-list__item_comment js-comment " rel="10552564">
    
    <span class="parent_id" data-parent_id="0"></span>
    <div class="comment" id="comment_10552564">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10552564">
          <a href="https://habr.com/ru/users/infrapro/" class="user-info user-info_inline" data-user-login="infrapro">
    <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/c0de45f60a8b8430220983ccf66e04a8.png" class="user-info__image-pic user-info__image-pic_small" width="24" height="24">
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">infrapro</span>
</a>

          <svg class="icon_comment-edit" title="Комментарий был изменен" width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#pencil"></use></svg>
          <time class="comment__date-time comment__date-time_published">5 декабря 2017 в 13:15</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10552564" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10552564" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>


  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10552564" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10552564" data-parent_id="0" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10552564" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message ">Очень похоже на мою реализацию ECS (CES — у нас почему-то всегда так называют этот подход), только вот за исключением что на каждый компонент у меня обязательно есть своя система. Почему, кстати, у вас нет RenderComponent'а, но есть RenderSystem? Еще не доконца ознакомился с вашей реализацией, не пойму как происходит обход parent-&gt;children? Я, вот, наделял Entity способностью добавлять child'ов и затем система обходила это дерево. Например если у Entity изменился компонент трансформации, то система брала чилдов этой сущности и обновляла их компоненты трансформации согласно родительской и так далее.<br>
Еще, кстати, для получения уникального Id объекта по инстацированию шаблонов, как сделано у вас в FamilyTypeID, можно вместо счетчика использовать адрес на локальную статичную переменную, например<br>
<pre><code class="cpp hljs">    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> typeid_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Id</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
    </span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> type_id = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeid_t</span></span>)(&amp;type_id);
    }</code></pre></div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-0" id="reply_comments_10552564">  <li class="content-list__item content-list__item_comment js-comment " rel="10552580">
    
    <span class="parent_id" data-parent_id="10552564"></span>
    <div class="comment" id="comment_10552580">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10552580">
          <a href="https://habr.com/ru/users/infrapro/" class="user-info user-info_inline" data-user-login="infrapro">
    <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/c0de45f60a8b8430220983ccf66e04a8.png" class="user-info__image-pic user-info__image-pic_small" width="24" height="24">
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">infrapro</span>
</a>

          
          <time class="comment__date-time comment__date-time_published">5 декабря 2017 в 13:21</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10552580" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10552580" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <span class="icon_comment-branch js-comment_tree" data-id="10552580" data-parent_id="10552564" title="Показать ветку комментариев"><svg width="8" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#tree"></use></svg></span>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#comment_10552564" class="icon_comment-arrow-up js-comment_parent" data-id="10552580" data-parent_id="10552564" title="Показать предыдущий комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
    </li>

  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10552580" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10552580" data-parent_id="10552564" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10552580" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message ">Ах, дико извиняюсь, я не заметил, что статья является переводом и автор статьи не является автором кода</div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-1" id="reply_comments_10552580"></ul>
  </li>
  <li class="content-list__item content-list__item_comment js-comment " rel="10553126">
    
    <span class="parent_id" data-parent_id="10552564"></span>
    <div class="comment" id="comment_10553126">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10553126">
          <a href="https://habr.com/ru/users/Neuyazvimy1/" class="user-info user-info_inline" data-user-login="Neuyazvimy1">
    <svg class="default-image default-image_mini default-image_lilac" width="24" height="24"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#slug"></use></svg>
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">Neuyazvimy1</span>
</a>

          
          <time class="comment__date-time comment__date-time_published">5 декабря 2017 в 18:00</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10553126" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10553126" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <span class="icon_comment-branch js-comment_tree" data-id="10553126" data-parent_id="10552564" title="Показать ветку комментариев"><svg width="8" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#tree"></use></svg></span>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#comment_10552564" class="icon_comment-arrow-up js-comment_parent" data-id="10553126" data-parent_id="10552564" title="Показать предыдущий комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
    </li>

  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10553126" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10553126" data-parent_id="10552564" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10553126" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message ">Полностью согласен. Проще было бы форкнуть<a href="https://github.com/alecthomas/entityx"> эту реализацию</a>, если уж очень захотелось свой ECS с блэкджеком и еще чем-то там.</div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-1" id="reply_comments_10553126"></ul>
  </li>
</ul>
  </li>
  <li class="content-list__item content-list__item_comment js-comment " rel="10553274">
    
    <span class="parent_id" data-parent_id="0"></span>
    <div class="comment" id="comment_10553274">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10553274">
          <a href="https://habr.com/ru/users/ser-mk/" class="user-info user-info_inline" data-user-login="ser-mk">
    <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/7dc15fc3eb7f68aea6913265bae9fab5.png" class="user-info__image-pic user-info__image-pic_small" width="24" height="24">
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">ser-mk</span>
</a>

          
          <time class="comment__date-time comment__date-time_published">5 декабря 2017 в 19:27</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10553274" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10553274" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>


  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10553274" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10553274" data-parent_id="0" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10553274" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message "><blockquote>Прочитать более широкое обсуждение по этой тематике можно в этих постах [2,3,4,5].</blockquote><br>
можно конечно подсмотреть в оригинале статьи)<br>
но что бы вдруг не потерялись, я бы разместил бы тут</div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-0" id="reply_comments_10553274">  <li class="content-list__item content-list__item_comment js-comment " rel="10553308">
    
    <span class="parent_id" data-parent_id="10553274"></span>
    <div class="comment" id="comment_10553308">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10553308">
          <a href="https://habr.com/ru/users/ser-mk/" class="user-info user-info_inline" data-user-login="ser-mk">
    <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/7dc15fc3eb7f68aea6913265bae9fab5.png" class="user-info__image-pic user-info__image-pic_small" width="24" height="24">
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">ser-mk</span>
</a>

          
          <time class="comment__date-time comment__date-time_published">5 декабря 2017 в 19:41</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10553308" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10553308" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <span class="icon_comment-branch js-comment_tree" data-id="10553308" data-parent_id="10553274" title="Показать ветку комментариев"><svg width="8" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#tree"></use></svg></span>
    </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#comment_10553274" class="icon_comment-arrow-up js-comment_parent" data-id="10553308" data-parent_id="10553274" title="Показать предыдущий комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
    </li>

  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10553308" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10553308" data-parent_id="10553274" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10553308" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message ">P.S. Очень неожиданно было увидеть справочную литературу в середине статьи)</div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-1" id="reply_comments_10553308"></ul>
  </li>
</ul>
  </li>
  <li class="content-list__item content-list__item_comment js-comment " rel="10553902">
    
    <span class="parent_id" data-parent_id="0"></span>
    <div class="comment" id="comment_10553902">
        <span class="comment__folding-dotholder"></span>
        <div class="comment__head   " rel="10553902">
          <a href="https://habr.com/ru/users/bibmaster/" class="user-info user-info_inline" data-user-login="bibmaster">
    <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/7baed8fa165d7f5dcc512b2a84593f8a.jpg" class="user-info__image-pic user-info__image-pic_small" width="24" height="24">
  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">bibmaster</span>
</a>

          
          <time class="comment__date-time comment__date-time_published">6 декабря 2017 в 09:22</time>
          <ul class="inline-list inline-list_comment-nav">
  <li class="inline-list__item inline-list__item_comment-nav">
    <a href="https://habr.com/ru/post/343778/#comment_10553902" class="icon_comment-anchor" title="Ссылка на комментарий"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#anchor"></use></svg></a>
  </li>

    <li class="inline-list__item inline-list__item_comment-nav">
      <a href="https://habr.com/ru/post/343778/#" class="icon_comment-bookmark " onclick="return comments_add_to_favorite(this)" data-type="3" data-id="10553902" data-action="add" title="Только зарегистрированные пользователи могут добавлять комментарии в избранное" disabled=""><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg></a>
    </li>


  <li class="inline-list__item inline-list__item_comment-nav hidden js-comment_children">
    <a href="https://habr.com/ru/post/343778/#comment_10553902" class="icon_comment-arrow-down js-comment_parent back_to_children" data-id="10553902" data-parent_id="0" title="Вернуться к ответу"><svg width="12" height="12"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#rounded-arrow"></use></svg></a>
  </li>
</ul>

            <div class="voting-wjt voting-wjt_comments js-comment-vote" data-id="10553902" data-post-target="343778" data-type="3">
    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="plus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-up" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>

    <span class="voting-wjt__counter   js-score" title="Общий рейтинг 0: ↑0 и ↓0">0</span>

    <button type="button" class="btn voting-wjt__button voting-wjt__button_small " data-action="minus" onclick="comment_vote(this);" title="Голосовать могут только зарегистрированные пользователи" disabled=""><svg class="icon-svg_arrow-down" width="10" height="16"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#vote-arrow"></use></svg></button>
  </div>

        </div>

        <div class="comment__message ">Кстати, интерфейс аллокатора общего назначения уже есть в стандарте: <a href="http://en.cppreference.com/w/cpp/memory/memory_resource">en.cppreference.com/w/cpp/memory/memory_resource</a></div>

        <div class="comment__footer">
</div>

        <div class="comment__reply-form js-form_placeholder"></div>
    </div>

    <ul class="content-list content-list_nested-comments content-list_nested-comments-0" id="reply_comments_10553902"></ul>
  </li>

      
    </ul>
    <div class="js-form_placeholder">
              <p class="for_users_only_msg">Только&nbsp;<a href="https://habr.com/info/help/registration/">полноправные пользователи</a> могут оставлять комментарии. <a href="https://habr.com/ru/auth/login/">Войдите</a>, пожалуйста.</p>

    </div>
  </div>


  </div>

    <div class="sidebar_right sidebar_comments js-sidebar_right">
          

  <div class="js-ad_sticky_comments">
    <div class="default-block">
      <div class="default-block__header">
        <h3 class="default-block__header-title">Что обсуждают</h3>
      </div>

      <div class="default-block__content default-block__content_most-comments" id="broadcast_tabs_comments">
        <ul class="toggle-menu toggle-menu_most-comments">
          <li class="toggle-menu__item">
            <a href="https://habr.com/ru/post/343778/#broadcast_comments_now" class="toggle-menu__item-link active" rel="nofollow">Сейчас</a>
          </li>
          <li class="toggle-menu__item">
            <a href="https://habr.com/ru/post/343778/#broadcast_comments_yesterday" class="toggle-menu__item-link" rel="nofollow">Вчера</a>
          </li>
          <li class="toggle-menu__item">
            <a href="https://habr.com/ru/post/343778/#broadcast_comments_week" class="toggle-menu__item-link" rel="nofollow">Неделя</a>
          </li>
        </ul>

          <div class="tabs__content" id="broadcast_comments_now" style="display: block;">
              <ul class="content-list content-list_most-comments">
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450978/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Как создать QR код для оплаты в платежной системе</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">689</span>
                    </span>
                    <a href="https://habr.com/ru/post/450978/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">0</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450894/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Про антенны для самых маленьких</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">12,5k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450894/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">42</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450886/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Справочная: как работают водородные автомобили и когда они появятся на дорогах</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">7,6k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450886/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">50</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450756/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">О боевых инкапаситантах</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">24,9k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450756/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">87</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/company/haulmont/blog/450914/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Переговоры провалены: как Oracle убила Java EE</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">11,3k</span>
                    </span>
                    <a href="https://habr.com/ru/company/haulmont/blog/450914/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">34</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
          <div class="tabs__content" id="broadcast_comments_yesterday" style="display: none;">
              <ul class="content-list content-list_most-comments">
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450770/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Авиакатастрофа в Шереметьево: исторические аналогии</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">19,3k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450770/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">160</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/company/itsumma/blog/450846/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Чудеса упаковки от Microsoft: ядро Linux в Windows 10 и движок IE внутри Chromium Edge</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">38k</span>
                    </span>
                    <a href="https://habr.com/ru/company/itsumma/blog/450846/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">120</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450848/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">О жёлтом фосфоре и панической природе человека</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">34k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450848/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">90</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450756/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">О боевых инкапаситантах</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">24,9k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450756/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">87</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450810/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Топ-7 способов быстрой проверки компетенций IT-специалистов до собеседования</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">7,2k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450810/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">71</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
          <div class="tabs__content" id="broadcast_comments_week" style="display: none;">
              <ul class="content-list content-list_most-comments">
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450294/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Самые страшные яды</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">99,9k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450294/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">565</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450536/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Выпускники американских университетов превосходят выпускников России, Китая и Индии</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">62,4k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450536/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">551</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450398/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">Самые нестрашные яды</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">54k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450398/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">347</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/company/ua-hosting/blog/450154/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">PlayStation следующего поколения: что же внутри?</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">33,2k</span>
                    </span>
                    <a href="https://habr.com/ru/company/ua-hosting/blog/450154/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">335</span>
                    </a>
                  </div>
                </li>
                  <li class="content-list__item content-list__item_devided post-info">
                    <a href="https://habr.com/ru/post/450228/" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;discussions&#39;, &#39;&#39;); }" class="post-info__title">10 мифов о бешенстве</a>

                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">61,2k</span>
                    </span>
                    <a href="https://habr.com/ru/post/450228/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">311</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
    </div>
  </div>

    </div>
  </div></section>

  <script>
  window._yaparams = {'hubs':[], 'flows':[] };
  // hubs to GA
  _yaparams['hubs'].push('programming (Программирование)');
  _yaparams['hubs'].push('cpp (C++)');
  _yaparams['hubs'].push('gamedev (Разработка игр)');
  _yaparams['flows'].push('develop (Разработка)');
</script>
  

  <script type="text/javascript">
    var userLabel = 'reader';
  </script>

  


        </div>
      </div>

        <div class="layout__row layout__row_promo-blocks">
          <div class="layout__cell">
            <section class="column-wrapper column-wrapper_bottom column-wrapper_bordered">
  <div class="content_left">
    

  <div class="default-block default-block_content">
    <div class="default-block__header default-block__header_large">
      <h2 class="default-block__header-title default-block__header-title_large">Самое читаемое</h2>
    </div>
    <div class="default-block__content default-block__content_most-read" id="broadcast_tabs_posts">
      <ul class="toggle-menu toggle-menu__most-read">
        <li class="toggle-menu__item">
          <a href="https://habr.com/ru/post/343778/#broadcast_posts_today" class="toggle-menu__item-link active" rel="nofollow">Сутки</a>
        </li>
        <li class="toggle-menu__item">
          <a href="https://habr.com/ru/post/343778/#broadcast_posts_week" class="toggle-menu__item-link" rel="nofollow">Неделя</a>
        </li>
        <li class="toggle-menu__item">
          <a href="https://habr.com/ru/post/343778/#broadcast_posts_month" class="toggle-menu__item-link" rel="nofollow">Месяц</a>
        </li>
      </ul>

        <div class="tabs__content tabs__content_reading" id="broadcast_posts_today" style="display: block;">
            <ul class="content-list content-list_most-read">
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/company/itsumma/blog/450846/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Чудеса упаковки от Microsoft: ядро Linux в Windows 10 и движок IE внутри Chromium Edge</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+53</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">38k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">51</span>
                    </span>
                    <a href="https://habr.com/ru/company/itsumma/blog/450846/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">120</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450848/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">О жёлтом фосфоре и панической природе человека</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+128</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">34k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">85</span>
                    </span>
                    <a href="https://habr.com/ru/post/450848/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">90</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450878/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Поймай меня, если сможешь</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+48</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">26,1k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">66</span>
                    </span>
                    <a href="https://habr.com/ru/post/450878/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">75</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/news/t/450900/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Умелец растворил банковскую карту в ацетоне, чтобы сделать кольцо для бесконтактных платежей</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+36</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">22,3k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">19</span>
                    </span>
                    <a href="https://habr.com/ru/news/t/450900/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">66</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/company/yandex/blog/449890/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Как проходят алгоритмические секции на собеседованиях в Яндекс</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+24</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">18,7k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">182</span>
                    </span>
                    <a href="https://habr.com/ru/company/yandex/blog/449890/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">47</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
        <div class="tabs__content tabs__content_reading" id="broadcast_posts_week" style="display: none;">
            <ul class="content-list content-list_most-read">
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450266/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Честное резюме программиста</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+350</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">123k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">403</span>
                    </span>
                    <a href="https://habr.com/ru/post/450266/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">257</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450294/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Самые страшные яды</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+267</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">99,9k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">426</span>
                    </span>
                    <a href="https://habr.com/ru/post/450294/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">565</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450536/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Выпускники американских университетов превосходят выпускников России, Китая и Индии</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+91</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">62,4k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">106</span>
                    </span>
                    <a href="https://habr.com/ru/post/450536/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">551</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450228/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">10 мифов о бешенстве</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+221</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">61,2k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">181</span>
                    </span>
                    <a href="https://habr.com/ru/post/450228/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">311</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450478/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Сегодня многие популярные аддоны для Firefox перестали работать из-за проблем с сертификатом</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+50</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">54,9k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">60</span>
                    </span>
                    <a href="https://habr.com/ru/post/450478/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">307</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
        <div class="tabs__content tabs__content_reading" id="broadcast_posts_month" style="display: none;">
            <ul class="content-list content-list_most-read">
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/449060/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Самый худший UI управления громкостью звука</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+259</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">153k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">225</span>
                    </span>
                    <a href="https://habr.com/ru/post/449060/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">175</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/448762/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Бунт на Пикабу. Пользователи массово уходят на Реддит</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+171</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">140k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">102</span>
                    </span>
                    <a href="https://habr.com/ru/post/448762/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">484</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/448530/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Как Мегафон спалился на мобильных подписках</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+607</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">124k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">228</span>
                    </span>
                    <a href="https://habr.com/ru/post/448530/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">659</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/450266/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">Честное резюме программиста</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+350</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">123k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">403</span>
                    </span>
                    <a href="https://habr.com/ru/post/450266/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">257</span>
                    </a>
                  </div>
                </li>
                <li class="content-list__item content-list__item_devided post-info">
                  <a href="https://habr.com/ru/post/447902/" class="post-info__title post-info__title_large" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;most_read&#39;, &#39;&#39;); }">GitHub полностью «удалил» репозиторий утилиты для обхода блокировок и весь аккаунт создателя</a>
                  <div class="post-info__meta">
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_rating" width="11" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#arrow-bold"></use></svg><span class="post-info__meta-counter">+113</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_views" width="16" height="9"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#eye"></use></svg><span class="post-info__meta-counter">111k</span>
                    </span>
                    <span class="post-info__meta-item">
                      <svg class="post-info__meta-icon icon-svg_bookmark-mini" width="8" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#book"></use></svg><span class="post-info__meta-counter">174</span>
                    </span>
                    <a href="https://habr.com/ru/post/447902/#comments" class="post-info__meta-item" rel="nofollow">
                      <svg class="post-info__meta-icon icon-svg_comments" width="14" height="13"><use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#comment"></use></svg><span class="post-info__meta-counter">441</span>
                    </a>
                  </div>
                </li>
            </ul>
        </div>
    </div>
  </div>

  </div>
  <div class="sidebar_right">
    <div class="default-block">
  <div class="default-block__header">
    <h2 class="default-block__header-title">Рекомендуем</h2>
      <a href="https://tmtm.ru/megapost" class="default-block__header-link" rel="nofollow" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;megapost_promo&#39;, &#39;order&#39;); }">Разместить</a>
  </div>
  <div class="default-block__content">
    <ul class="megapost-teasers megapost-teasers_sidebar">
        <li class="megapost-teasers__item megapost-teasers__item_sidebar teaser">
          <a href="https://u.tmtm.ru/tinkof_invest_promo" target="_blank" class="teaser__image" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;megapost_promo&#39;, &#39;article_pic&#39;); }" rel="nofollow noopener">
            <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/b029f3db4585b43ff8262de29d12d1f2.jpg" class="teaser__image-pic">
          </a>
          <a href="https://u.tmtm.ru/tinkof_invest_promo" target="_blank" class="teaser__body" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;megapost_promo&#39;, &#39;article_title&#39;); }" rel="nofollow noopener">
            <h3 class="teaser__body-title">Скромный стартап в большой корпорации: как создавали Тинькофф Инвестиции</h3>
          </a>
        </li>
        <li class="megapost-teasers__item megapost-teasers__item_sidebar teaser">
          <a href="https://u.tmtm.ru/p-inno-q-050419" target="_blank" class="teaser__image" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;megapost_promo&#39;, &#39;article_pic&#39;); }" rel="nofollow noopener">
            <img src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/5172769fe25d334e692462f689088676.jpg" class="teaser__image-pic">
          </a>
          <a href="https://u.tmtm.ru/p-inno-q-050419" target="_blank" class="teaser__body" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;tm_block&#39;, &#39;megapost_promo&#39;, &#39;article_title&#39;); }" rel="nofollow noopener">
            <h3 class="teaser__body-title">Иннополис-квест: как тимлид себе команду искал</h3>
          </a>
        </li>
    </ul>
  </div>
</div>

  </div>
</section>

          </div>
        </div>

      <div class="layout__row layout__row_footer-links">
        <div class="layout__cell">
          <div class="footer-grid footer-grid_menu">
  <div class="footer-grid__item footer-block">
    <h3 class="footer-block__title">
      Аккаунт
    </h3>
    <div class="footer-block__content">
      <ul class="footer-menu">
          <li class="footer-menu__item">
            <a href="https://habr.com/ru/auth/login/" class="footer-menu__item-link">Войти</a>
          </li>
          <li class="footer-menu__item">
            <a href="https://habr.com/ru/auth/register/" class="footer-menu__item-link">Регистрация</a>
          </li>
      </ul>
    </div>
  </div>

  <div class="footer-grid__item footer-block">
    <h3 class="footer-block__title">Разделы</h3>
    <div class="footer-block__content">
      <ul class="footer-menu">
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/posts/top/" class="footer-menu__item-link">Публикации</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/news/" class="footer-menu__item-link">Новости</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/hubs/" class="footer-menu__item-link">Хабы</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/companies/" class="footer-menu__item-link">Компании</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/users/" class="footer-menu__item-link">Пользователи</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/sandbox/" class="footer-menu__item-link">Песочница</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="footer-grid__item footer-block">
    <h3 class="footer-block__title">Информация</h3>
    <div class="footer-block__content">
      <ul class="footer-menu">
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/info/help/rules/" class="footer-menu__item-link">Правила</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/info/help/" class="footer-menu__item-link">Помощь</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://habr.com/ru/info/topics/madskillz/" class="footer-menu__item-link">Документация</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://account.habr.com/info/agreement/?hl=ru_RU" class="footer-menu__item-link">Соглашение</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://account.habr.com/info/confidential/?hl=ru_RU" class="footer-menu__item-link">Конфиденциальность</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="footer-grid__item footer-block">
    <h3 class="footer-block__title">Услуги</h3>
    <div class="footer-block__content">
      <ul class="footer-menu">
        <li class="footer-menu__item">
          <a href="https://tmtm.ru/services/advertising/" target="_blank" class="footer-menu__item-link" rel=" noopener">Реклама</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://tmtm.ru/services/corpblog/" target="_blank" class="footer-menu__item-link" rel=" noopener">Тарифы</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://tmtm.ru/services/content/" target="_blank" class="footer-menu__item-link" rel=" noopener">Контент</a>
        </li>
        <li class="footer-menu__item">
          <a href="https://tmtm.ru/workshops/" target="_blank" class="footer-menu__item-link" rel=" noopener">Семинары</a>
        </li>
      </ul>
    </div>
  </div>

    <div class="footer-grid__item footer-grid__item_300 footer-block">
      <h3 class="footer-block__title">Приложения</h3>
      <div class="footer-block__content footer-block__content_apps">
        <a href="https://appmetrica.yandex.com/serve/240693928167260216?utm_source=HH_desktop&amp;utm_medium=button&amp;utm_campaign=appiOS" class="footer-menu__app" target="_blank" onclick="if (  typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;links&#39;, &#39;ios_app&#39;); }" rel=" noopener"><svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="140" height="40" viewBox="0 0 140 40"><path fill="#fff" d="M0 0h140v40h-140z"></path><path d="M139.387 35.99c0 2.215-1.794 4.01-4.014 4.01h-131.354c-2.218 0-4.019-1.794-4.019-4.01v-31.975c0-2.214 1.801-4.015 4.019-4.015h131.353c2.22 0 4.014 1.801 4.014 4.015l.001 31.975z"></path><path fill="#fff" d="M30.609 19.78c-.03-3.374 2.763-5.016 2.89-5.092-1.582-2.306-4.034-2.621-4.895-2.647-2.059-.217-4.057 1.232-5.106 1.232-1.07 0-2.685-1.211-4.426-1.176-2.24.035-4.336 1.332-5.486 3.346-2.372 4.107-.603 10.142 1.67 13.462 1.137 1.626 2.465 3.441 4.204 3.377 1.701-.07 2.337-1.085 4.39-1.085 2.034 0 2.631 1.085 4.404 1.044 1.826-.029 2.975-1.633 4.072-3.274 1.314-1.863 1.841-3.699 1.862-3.793-.041-.013-3.544-1.35-3.579-5.394zM27.259 9.858c.915-1.144 1.541-2.701 1.367-4.281-1.324.059-2.981.916-3.934 2.035-.844.986-1.598 2.603-1.403 4.123 1.488.111 3.015-.751 3.97-1.877zM55.229 32.05h-2.378l-1.302-4.092h-4.527l-1.241 4.092h-2.315l4.485-13.932h2.77l4.508 13.932zm-4.072-5.809l-1.178-3.638c-.125-.372-.358-1.247-.702-2.625h-.042c-.137.593-.358 1.468-.662 2.625l-1.157 3.638h3.741zM66.763 26.903c0 1.709-.462 3.059-1.385 4.05-.827.883-1.854 1.323-3.08 1.323-1.323 0-2.274-.475-2.853-1.426h-.042v5.292h-2.232v-10.831c0-1.074-.028-2.177-.083-3.307h1.963l.125 1.592h.042c.744-1.2 1.874-1.799 3.39-1.799 1.185 0 2.174.468 2.966 1.405.793.938 1.189 2.172 1.189 3.701zm-2.274.082c0-.978-.22-1.784-.662-2.418-.483-.662-1.131-.992-1.943-.992-.551 0-1.051.184-1.498.548-.448.366-.741.845-.878 1.437-.069.276-.104.503-.104.68v1.675c0 .731.224 1.347.672 1.851s1.03.755 1.746.755c.841 0 1.495-.325 1.963-.972.47-.648.704-1.503.704-2.564zM78.318 26.903c0 1.709-.462 3.059-1.386 4.05-.826.883-1.853 1.323-3.079 1.323-1.323 0-2.274-.475-2.852-1.426h-.042v5.292h-2.232v-10.831c0-1.074-.028-2.177-.083-3.307h1.963l.125 1.592h.042c.743-1.2 1.873-1.799 3.39-1.799 1.184 0 2.173.468 2.967 1.405.79.938 1.187 2.172 1.187 3.701zm-2.274.082c0-.978-.221-1.784-.663-2.418-.483-.662-1.129-.992-1.942-.992-.552 0-1.051.184-1.499.548-.448.366-.74.845-.877 1.437-.068.276-.104.503-.104.68v1.675c0 .731.224 1.347.67 1.851.448.503 1.03.755 1.748.755.841 0 1.495-.325 1.963-.972.469-.648.704-1.503.704-2.564zM91.236 28.143c0 1.185-.411 2.149-1.237 2.894-.908.813-2.171 1.22-3.795 1.22-1.499 0-2.701-.289-3.611-.868l.517-1.86c.98.593 2.055.89 3.227.89.841 0 1.495-.191 1.965-.57.468-.379.701-.888.701-1.522 0-.565-.193-1.042-.579-1.428-.384-.386-1.026-.745-1.922-1.077-2.439-.91-3.658-2.242-3.658-3.995 0-1.145.427-2.084 1.282-2.815.852-.732 1.989-1.097 3.411-1.097 1.268 0 2.321.221 3.162.662l-.558 1.82c-.785-.427-1.673-.641-2.666-.641-.785 0-1.399.194-1.838.579-.372.344-.558.764-.558 1.262 0 .551.213 1.006.64 1.364.372.331 1.047.689 2.027 1.075 1.199.483 2.079 1.047 2.646 1.694.563.642.844 1.45.844 2.413zM98.616 23.679h-2.46v4.878c0 1.241.433 1.86 1.302 1.86.399 0 .73-.035.991-.104l.062 1.695c-.44.164-1.019.247-1.736.247-.881 0-1.57-.269-2.068-.806-.495-.538-.744-1.441-.744-2.708v-5.064h-1.466v-1.675h1.466v-1.839l2.192-.662v2.501h2.46l.001 1.677zM109.716 26.944c0 1.544-.442 2.812-1.323 3.803-.924 1.021-2.151 1.53-3.681 1.53-1.474 0-2.648-.489-3.523-1.467s-1.313-2.212-1.313-3.7c0-1.557.45-2.832 1.354-3.823.901-.992 2.118-1.489 3.647-1.489 1.474 0 2.66.489 3.555 1.468.857.95 1.284 2.176 1.284 3.678zm-2.315.072c0-.927-.198-1.721-.599-2.384-.468-.802-1.137-1.202-2.004-1.202-.897 0-1.579.401-2.047 1.202-.401.664-.599 1.471-.599 2.426 0 .927.198 1.721.599 2.383.483.802 1.157 1.202 2.027 1.202.852 0 1.521-.408 2.004-1.223.411-.675.619-1.478.619-2.404zM116.971 23.967c-.221-.041-.456-.062-.704-.062-.785 0-1.392.296-1.82.89-.372.523-.558 1.185-.558 1.984v5.271h-2.231l.021-6.882c0-1.158-.028-2.212-.084-3.163h1.944l.082 1.922h.062c.236-.661.607-1.192 1.116-1.591.497-.359 1.034-.538 1.613-.538.206 0 .393.015.558.041l.001 2.128zM126.954 26.552c0 .4-.026.737-.082 1.012h-6.696c.026.992.35 1.751.972 2.275.564.468 1.294.702 2.19.702.991 0 1.896-.158 2.709-.475l.35 1.549c-.951.415-2.073.621-3.368.621-1.558 0-2.781-.459-3.67-1.375s-1.333-2.146-1.333-3.689c0-1.515.414-2.776 1.242-3.782.867-1.074 2.038-1.611 3.512-1.611 1.448 0 2.544.537 3.288 1.611.589.853.886 1.908.886 3.162zm-2.129-.579c.015-.662-.131-1.233-.433-1.716-.386-.621-.98-.931-1.779-.931-.73 0-1.323.303-1.777.91-.372.483-.593 1.062-.661 1.736l4.649.001zM44.529 6.682c.238-.142.506-.262.807-.36s.654-.148 1.062-.148c.656 0 1.174.156 1.553.467s.568.731.568 1.259c0 .42-.127.772-.38 1.056s-.578.474-.97.568v.03c.217.035.422.093.615.178s.363.198.508.34c.146.142.261.308.345.498.084.189.127.399.127.63 0 .379-.076.697-.229.955s-.352.467-.599.63c-.246.162-.522.28-.827.35s-.609.107-.914.107c-.326 0-.647-.035-.965-.102s-.612-.179-.884-.335l.274-.843c.176.088.403.173.68.254.277.082.558.121.843.121.467 0 .828-.105 1.081-.314.253-.21.381-.491.381-.843 0-.238-.051-.431-.153-.584-.103-.153-.235-.272-.397-.361-.162-.088-.343-.149-.543-.182s-.398-.051-.594-.051h-.457v-.831h.457c.209 0 .404-.026.584-.082.179-.053.335-.13.467-.228s.236-.216.31-.351c.073-.135.111-.288.111-.457 0-.305-.109-.543-.326-.716s-.508-.26-.873-.26c-.25 0-.501.041-.752.121-.25.082-.474.17-.671.264l-.239-.78zM53.251 13.131l-.081-.568h-.03c-.331.453-.811.68-1.442.68-.224 0-.426-.038-.609-.112s-.342-.176-.477-.305c-.136-.129-.24-.281-.315-.457-.074-.176-.111-.37-.111-.579 0-.616.25-1.078.752-1.386s1.211-.462 2.133-.462v-.091c0-.65-.341-.975-1.024-.975-.487 0-.916.122-1.287.365l-.223-.72c.453-.284 1.018-.426 1.693-.426 1.291 0 1.937.68 1.937 2.041v1.817c0 .508.024.9.071 1.178h-.986zm-.152-2.457c-.612 0-1.069.077-1.368.233s-.449.41-.449.762c0 .258.07.45.211.579s.32.193.536.193c.141 0 .275-.025.404-.076.128-.05.24-.12.337-.208.098-.088.177-.195.239-.32.061-.126.09-.259.09-.401v-.762zM59.457 8.196v.904h-2.052v4.032h-1.096v-4.936h3.148zM65.732 10.603c0 .393-.054.752-.162 1.076-.109.326-.259.603-.452.832-.193.23-.423.41-.69.538-.268.129-.563.194-.889.194-.65 0-1.117-.233-1.402-.7h-.021v2.599h-1.097v-5.321l-.01-.798-.029-.828h.964l.062.782h.021c.365-.588.92-.884 1.666-.884.29 0 .56.061.807.182.247.122.462.293.645.513s.327.484.431.793c.103.309.156.649.156 1.022zm-1.116.041c0-.244-.029-.469-.087-.675s-.142-.382-.253-.528-.247-.261-.406-.345c-.159-.085-.337-.127-.534-.127-.155 0-.308.035-.457.102-.15.067-.28.159-.39.274-.112.115-.201.254-.269.417s-.103.335-.103.518v.823c0 .182.028.352.087.508s.138.291.243.406.23.205.376.269c.146.065.306.096.482.096.414 0 .735-.157.965-.472.229-.316.346-.739.346-1.266zM71.624 8.196l-1.25 3.422c-.297.812-.587 1.477-.868 1.995s-.55.895-.807 1.133c-.379.338-.782.545-1.209.619l-.264-.923c.284-.074.555-.22.812-.437s.463-.487.62-.812l.081-.223-.061-.233-1.788-4.54h1.208l.935 2.752.142.437.153.538h.021l.111-.411.162-.574.833-2.742 1.168-.001zM73.523 10.247h.507c.372 0 .661-.067.863-.203s.305-.302.305-.498c0-.203-.086-.365-.26-.487-.172-.121-.411-.183-.716-.183-.197 0-.395.032-.593.096-.2.065-.384.144-.554.239l-.284-.71c.284-.155.566-.262.849-.319.281-.058.562-.087.847-.087.225 0 .45.022.676.066.225.044.427.118.603.223s.321.242.431.411c.112.17.168.379.168.63 0 .156-.03.293-.092.411-.06.118-.141.223-.243.314s-.215.166-.339.223c-.125.058-.253.101-.38.128v.03c.161.021.319.062.472.122.152.061.288.14.411.239.12.098.219.217.294.355.073.139.11.296.11.472 0 .291-.069.535-.213.731-.141.197-.323.352-.544.467-.219.115-.462.198-.726.249s-.521.076-.771.076c-.305 0-.607-.032-.903-.096-.298-.065-.566-.164-.804-.299l.286-.721c.176.095.376.175.603.239s.459.096.695.096c.372 0 .659-.072.858-.218.198-.146.298-.327.298-.543 0-.142-.032-.262-.101-.36-.068-.098-.163-.178-.284-.239-.122-.061-.264-.104-.427-.127-.161-.024-.339-.036-.528-.036h-.517v-.691zM79.381 8.196v1.746c0 .4-.006.759-.021 1.076l-.051 1.005.021.02.38-.757.382-.757 1.219-2.336h1.421v4.935h-1.036v-1.746c0-.365.01-.731.026-1.096l.055-1.108h-.051c-.114.305-.229.568-.345.793l-.343.691-.626 1.219c-.206.406-.425.823-.654 1.249h-1.421v-4.934h1.044zM88.521 8.196v.904h-1.502v4.032h-1.079v-4.032h-1.493v-.904h4.074zM94.115 10.43l-.01.269-.03.228h-3.29c.015.467.161.828.442 1.081s.652.381 1.112.381c.481 0 .924-.077 1.331-.233l.172.762c-.468.203-1.019.305-1.656.305-.384 0-.73-.06-1.034-.178-.305-.118-.562-.286-.773-.503-.208-.217-.371-.477-.483-.782-.11-.305-.165-.646-.165-1.025s.055-.73.165-1.051c.112-.321.27-.601.472-.838.204-.238.45-.423.736-.559.288-.135.609-.203.961-.203.311 0 .593.055.849.168.253.111.47.27.648.477.18.206.317.454.411.741s.142.609.142.96zm-1.047-.283c0-.386-.092-.699-.278-.939s-.455-.361-.807-.361c-.319 0-.588.121-.811.365s-.352.555-.386.935h2.282zM98.534 8.237c.197-.033.446-.061.751-.082s.616-.03.935-.03c.202 0 .431.013.685.036s.497.077.726.162c.231.085.423.211.579.381s.236.399.236.69c0 .15-.028.284-.082.401-.055.118-.127.222-.219.31s-.197.161-.315.218c-.118.058-.241.101-.371.127l.01.03c.358.061.65.189.873.386s.335.467.335.812c0 .345-.096.62-.284.823-.191.203-.423.356-.701.457s-.571.166-.879.194c-.307.026-.583.041-.826.041-.272 0-.538-.006-.798-.021l-.654-.041v-4.894zm1.056 1.97h.558c.17 0 .331-.012.483-.036.153-.023.286-.061.401-.111.116-.051.204-.118.27-.203.064-.085.096-.187.096-.31 0-.223-.092-.387-.281-.492-.186-.105-.478-.157-.877-.157l-.3.01-.35.03v1.269zm0 2.183l.339.03.321.01c.15 0 .3-.009.456-.03.155-.02.298-.059.427-.116s.231-.134.309-.232c.077-.097.118-.227.118-.388 0-.283-.127-.477-.376-.585-.251-.108-.588-.161-1.017-.161h-.577v1.472z"></path></svg></a>

        <a href="https://appmetrica.yandex.com/serve/745097116363323173?id=ru.habrahabr&amp;utm_source=HH_desktop&amp;utm_medium=button&amp;utm_campaign=appAndroid" class="footer-menu__app" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;links&#39;, &#39;android_app&#39;); }" rel=" noopener"><svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="135" height="40" viewBox="0 0 135 40"><path d="M130 40h-125c-2.75 0-5-2.25-5-5v-30c0-2.75 2.25-5 5-5h125c2.75 0 5 2.25 5 5v30c0 2.75-2.25 5-5 5z"></path><path fill="#fff" d="M68.136 21.752c-2.352 0-4.269 1.788-4.269 4.253 0 2.449 1.917 4.253 4.269 4.253 2.352 0 4.269-1.804 4.269-4.253 0-2.465-1.917-4.253-4.269-4.253zm0 6.83c-1.289 0-2.401-1.063-2.401-2.578 0-1.531 1.112-2.578 2.401-2.578 1.289 0 2.4 1.047 2.4 2.578 0 1.515-1.111 2.578-2.4 2.578zm-9.314-6.83c-2.352 0-4.269 1.788-4.269 4.253 0 2.449 1.917 4.253 4.269 4.253 2.352 0 4.269-1.804 4.269-4.253.001-2.465-1.916-4.253-4.269-4.253zm0 6.83c-1.289 0-2.4-1.063-2.4-2.578 0-1.531 1.112-2.578 2.4-2.578 1.289 0 2.4 1.047 2.4 2.578.001 1.515-1.111 2.578-2.4 2.578zm-11.078-5.525v1.804h4.318c-.129 1.015-.467 1.756-.983 2.272-.628.628-1.611 1.321-3.335 1.321-2.658 0-4.736-2.143-4.736-4.801s2.078-4.801 4.736-4.801c1.434 0 2.481.564 3.254 1.289l1.273-1.273c-1.079-1.031-2.513-1.82-4.527-1.82-3.641 0-6.702 2.964-6.702 6.605 0 3.641 3.061 6.605 6.702 6.605 1.966 0 3.448-.644 4.608-1.853 1.192-1.192 1.563-2.868 1.563-4.221 0-.419-.032-.806-.097-1.128h-6.074zm45.308 1.401c-.354-.95-1.434-2.706-3.641-2.706-2.191 0-4.011 1.724-4.011 4.253 0 2.384 1.804 4.253 4.221 4.253 1.949 0 3.077-1.192 3.544-1.885l-1.45-.967c-.483.709-1.144 1.176-2.094 1.176-.951 0-1.627-.435-2.062-1.289l5.687-2.352-.194-.483zm-5.8 1.418c-.048-1.643 1.273-2.481 2.223-2.481.741 0 1.369.371 1.579.902l-3.802 1.579zm-4.623 4.124h1.869v-12.501h-1.869v12.501zm-3.062-7.298h-.064c-.419-.499-1.224-.951-2.239-.951-2.127 0-4.076 1.869-4.076 4.269 0 2.384 1.949 4.237 4.076 4.237 1.015 0 1.82-.451 2.239-.967h.064v.612c0 1.627-.87 2.497-2.272 2.497-1.144 0-1.853-.822-2.143-1.514l-1.627.677c.467 1.128 1.708 2.513 3.77 2.513 2.191 0 4.044-1.289 4.044-4.43v-7.636h-1.772v.693zm-2.142 5.88c-1.289 0-2.368-1.079-2.368-2.562 0-1.498 1.079-2.594 2.368-2.594 1.273 0 2.272 1.096 2.272 2.594-.001 1.483-.999 2.562-2.272 2.562zm24.381-11.083h-4.471v12.501h1.865v-4.736h2.606c2.068 0 4.101-1.497 4.101-3.882s-2.033-3.883-4.101-3.883zm.048 6.025h-2.654v-4.285h2.654c1.395 0 2.187 1.155 2.187 2.143 0 .968-.792 2.142-2.187 2.142zm11.532-1.795c-1.351 0-2.75.595-3.329 1.914l1.657.692c.354-.692 1.013-.917 1.705-.917.965 0 1.946.579 1.962 1.608v.129c-.338-.193-1.062-.483-1.946-.483-1.785 0-3.603.981-3.603 2.815 0 1.673 1.464 2.75 3.104 2.75 1.255 0 1.946-.563 2.38-1.222h.064v.965h1.801v-4.793c0-2.22-1.656-3.458-3.795-3.458zm-.225 6.851c-.611 0-1.464-.306-1.464-1.062 0-.965 1.062-1.335 1.978-1.335.82 0 1.206.177 1.705.418-.145 1.159-1.142 1.979-2.219 1.979zm10.582-6.578l-2.139 5.42h-.064l-2.219-5.42h-2.01l3.329 7.575-1.898 4.214h1.946l5.131-11.789h-2.076zm-16.807 7.998h1.866v-12.501h-1.866v12.501z"></path><lineargradient id="a" gradientUnits="userSpaceOnUse" x1="21.8" y1="33.29" x2="5.017" y2="16.508" gradientTransform="matrix(1 0 0 -1 0 42)"><stop offset="0" stop-color="#00A0FF"></stop><stop offset=".007" stop-color="#00A1FF"></stop><stop offset=".26" stop-color="#00BEFF"></stop><stop offset=".512" stop-color="#00D2FF"></stop><stop offset=".76" stop-color="#00DFFF"></stop><stop offset="1" stop-color="#00E3FF"></stop></lineargradient><path fill="url(#a)" d="M10.435 7.538c-.291.308-.463.786-.463 1.405v22.116c0 .62.172 1.097.463 1.405l.074.072 12.389-12.389v-.292l-12.389-12.39-.074.073z"></path><lineargradient id="b" gradientUnits="userSpaceOnUse" x1="33.834" y1="21.999" x2="9.637" y2="21.999" gradientTransform="matrix(1 0 0 -1 0 42)"><stop offset="0" stop-color="#FFE000"></stop><stop offset=".409" stop-color="#FFBD00"></stop><stop offset=".775" stop-color="#FFA500"></stop><stop offset="1" stop-color="#FF9C00"></stop></lineargradient><path fill="url(#b)" d="M27.028 24.278l-4.129-4.131v-.292l4.13-4.13.093.053 4.893 2.78c1.398.794 1.398 2.093 0 2.888l-4.893 2.78-.094.052z"></path><lineargradient id="c" gradientUnits="userSpaceOnUse" x1="24.827" y1="19.704" x2="2.069" y2="-3.054" gradientTransform="matrix(1 0 0 -1 0 42)"><stop offset="0" stop-color="#FF3A44"></stop><stop offset="1" stop-color="#C31162"></stop></lineargradient><path fill="url(#c)" d="M27.122 24.225l-4.224-4.224-12.463 12.463c.461.488 1.221.548 2.078.061l14.609-8.3"></path><lineargradient id="d" gradientUnits="userSpaceOnUse" x1="7.297" y1="41.824" x2="17.46" y2="31.661" gradientTransform="matrix(1 0 0 -1 0 42)"><stop offset="0" stop-color="#32A071"></stop><stop offset=".069" stop-color="#2DA771"></stop><stop offset=".476" stop-color="#15CF74"></stop><stop offset=".801" stop-color="#06E775"></stop><stop offset="1" stop-color="#00F076"></stop></lineargradient><path fill="url(#d)" d="M27.122 15.777l-14.608-8.3c-.857-.487-1.617-.426-2.078.061l12.463 12.463 4.223-4.224z"></path><path opacity=".2" enable-background="new" d="M27.029 24.132l-14.515 8.247c-.812.461-1.538.431-2.004.011l-.075.075.074.072c.466.42 1.192.451 2.004-.011l14.608-8.3-.092-.094z"></path><path opacity=".12" enable-background="new" d="M10.435 32.318c-.291-.308-.463-.786-.463-1.405v.146c0 .619.172 1.097.463 1.405l.075-.075-.075-.071zM32.015 21.299l-4.986 2.833.093.093 4.893-2.78c.699-.397 1.048-.92 1.048-1.443-.059.473-.415.937-1.048 1.297z"></path><path opacity=".25" fill="#fff" enable-background="new" d="M12.514 7.623l19.501 11.08c.634.36.989.824 1.048 1.298 0-.523-.349-1.047-1.048-1.444l-19.501-11.08c-1.398-.794-2.541-.135-2.541 1.466v.147c0-1.601 1.143-2.261 2.541-1.467z"></path><g fill="#fff" stroke="#fff" stroke-width=".2" stroke-miterlimit="10"><path d="M42.114 14.273h-.737v-2.011h.587c.519-.447.773-1.212.763-2.296v-2.966h4.006v5.263h.67v2.011h-.737v-1.274h-4.551v1.273zm1.383-4.306c.012.949-.179 1.715-.569 2.296h3.033v-4.526h-2.464v2.23zM53.415 12.225c-.59.607-1.323.909-2.2.909-.877 0-1.61-.303-2.199-.909-.59-.606-.884-1.348-.884-2.225s.294-1.619.884-2.225c.589-.607 1.322-.91 2.199-.91.872 0 1.604.305 2.196.914.592.609.888 1.349.888 2.221-.001.877-.296 1.619-.884 2.225zm-3.831-.503c.444.45.987.674 1.63.674.642 0 1.187-.225 1.63-.674.444-.45.667-1.024.667-1.722s-.223-1.273-.667-1.722c-.443-.45-.987-.674-1.63-.674-.643 0-1.186.225-1.63.674-.443.45-.666 1.024-.666 1.722s.223 1.273.666 1.722zM58.179 13.134c-.883 0-1.623-.299-2.221-.896-.598-.598-.896-1.344-.896-2.238s.298-1.64.896-2.237c.598-.598 1.338-.897 2.221-.897.904 0 1.64.327 2.204.981l-.537.52c-.407-.509-.964-.763-1.667-.763-.654 0-1.206.221-1.655.662-.45.441-.675 1.02-.675 1.734s.225 1.293.675 1.734c.449.441 1.001.662 1.655.662.721 0 1.335-.29 1.844-.871l.536.536c-.274.33-.617.591-1.031.783-.413.194-.863.29-1.349.29zM63.677 13h-.771v-5.263h-1.676v-.737h4.123v.737h-1.676v5.263zM70.646 7l-2.271 5.061c-.313.715-.779 1.072-1.399 1.072-.185 0-.383-.044-.596-.134l.201-.712c.129.073.263.109.402.109.179 0 .317-.035.415-.104.098-.07.188-.197.272-.381l.218-.478-2.017-4.433h.905l1.483 3.444h.033l1.449-3.444h.905zM71.52 13v-6h4.341v6h-.771v-5.263h-2.8v5.263h-.77zM77.234 13v-6h.771v2.572h3v-2.572h.771v6h-.771v-2.707h-3v2.707h-.771zM88.058 12.225c-.59.607-1.323.909-2.2.909-.877 0-1.61-.303-2.199-.909-.59-.606-.884-1.348-.884-2.225s.294-1.619.884-2.225c.589-.607 1.322-.91 2.199-.91.872 0 1.604.305 2.196.914.592.609.888 1.349.888 2.221-.001.877-.296 1.619-.884 2.225zm-3.83-.503c.444.45.987.674 1.63.674s1.187-.225 1.63-.674c.444-.45.667-1.024.667-1.722s-.223-1.273-.667-1.722c-.443-.45-.987-.674-1.63-.674s-1.186.225-1.63.674c-.443.45-.666 1.024-.666 1.722s.222 1.273.666 1.722zM92.094 13v-6h2.17c.47 0 .876.155 1.22.465.344.311.516.7.516 1.169 0 .285-.074.537-.223.754-.147.218-.345.383-.591.495v.033c.296.101.539.274.729.519.189.246.285.531.285.855 0 .492-.181.899-.541 1.223-.36.325-.786.487-1.278.487h-2.287zm.77-3.428h1.399c.291 0 .524-.096.7-.289.176-.192.264-.403.264-.632s-.085-.439-.256-.628c-.17-.19-.395-.285-.674-.285h-1.434v1.834zm0 2.691h1.551c.296 0 .536-.104.721-.311.185-.206.276-.433.276-.679 0-.246-.095-.47-.285-.674-.189-.204-.438-.306-.746-.306h-1.517v1.97z"></path></g></svg></a>
      </div>
    </div>
</div>

<div class="footer-misprints">
  Если нашли опечатку в&nbsp;посте, выделите ее&nbsp;и&nbsp;нажмите Ctrl+Enter, чтобы сообщить автору.
</div>

        </div>
      </div>

      <div class="layout__row layout__row_footer">
        <div class="layout__cell">
          <div class="footer-grid footer">
  <div class="footer-grid__item footer-grid__item_copyright">
    <span class="footer__logo"><svg class="icon-svg icon-svg_tmtm" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="32" height="32" viewBox="0 0 32 32"><path fill="#b12b51" d="M0 0v32h23.637l4.175-4.189-4.175 4.175v-8.358h8.358l-4.184 4.184 4.189-4.184v-23.628h-32zm14.653 14.148h-2.088v5.127h-2.106v-5.127h-2.089v-1.423h6.282v1.423zm8.977 1.852v3.275h-2.048v-4.065l-1.487 2.683h-.922l-1.487-2.683v4.065h-1.989v-6.55h2.28l1.686 2.975 1.686-2.975h2.281v3.275z"></path><path fill="#fff" d="M8.37 14.148h2.088v5.127h2.106v-5.127h2.089v-1.423h-6.283zM22.264 12.725h-.915l-1.686 2.975-1.686-2.975h-2.28v6.55h1.989v-4.065l1.487 2.683h.922l1.487-2.683v4.065h2.048v-6.55h-.649z"></path><path fill="#dc82a0" d="M23.637 23.628v8.358l8.358-8.358z"></path></svg></span>
    <span class="footer__copyright">© 2006 – 2019 «<a href="https://tmtm.ru/" class="footer__link">TM</a>»</span>
  </div>
    <div class="footer-grid__item footer-grid__item_link footer-grid__item_lang">
      <svg class="icon-svg icon-svg_lang-footer" width="16" height="16">
        <use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#globus"></use>
      </svg>
      <a href="https://habr.com/ru/post/343778/#" class="footer__link js-show_lang_settings">Настройка языка</a>
    </div>
  <div class="footer-grid__item footer-grid__item_link">
      <a href="https://habr.com/ru/info/about/" class="footer__link">О сайте</a>
  </div>
  <div class="footer-grid__item footer-grid__item_link">
    <a href="https://habr.com/ru/feedback/" class="footer__link">Служба поддержки</a>
  </div>
  <div class="footer-grid__item footer-grid__item_link">
      <a href="https://m.habr.com/post/343778/?mobile=yes" class="footer__link">Мобильная версия</a>
  </div>

  <div class="footer-grid__item footer-grid__item_social">
    <ul class="social-icons">
      <li class="social-icons__item">
        <a href="https://twitter.com/habr_com" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_twitter" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;twitter&#39;); }" rel=" noopener">
          <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M17.414 8.642c-.398.177-.826.296-1.276.35.459-.275.811-.71.977-1.229-.43.254-.905.439-1.41.539-.405-.432-.982-.702-1.621-.702-1.227 0-2.222.994-2.222 2.222 0 .174.019.344.058.506-1.846-.093-3.484-.978-4.579-2.322-.191.328-.301.71-.301 1.117 0 .77.392 1.45.988 1.849-.363-.011-.706-.111-1.006-.278v.028c0 1.077.766 1.974 1.782 2.178-.187.051-.383.078-.586.078-.143 0-.282-.014-.418-.04.282.882 1.103 1.525 2.075 1.542-.76.596-1.718.951-2.759.951-.179 0-.356-.01-.53-.031.983.63 2.15.998 3.406.998 4.086 0 6.321-3.386 6.321-6.321l-.006-.287c.433-.314.81-.705 1.107-1.15z"></path></svg>
        </a>
      </li>
      <li class="social-icons__item">
        <a href="https://www.facebook.com/habrahabr.ru" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_facebook" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;facebook&#39;); }" rel=" noopener">
          <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M14.889 8.608h-1.65c-.195 0-.413.257-.413.6v1.192h2.063v1.698h-2.063v5.102h-1.948v-5.102h-1.766v-1.698h1.766v-1c0-1.434.995-2.6 2.361-2.6h1.65v1.808z"></path></svg>
        </a>
      </li>
        <li class="social-icons__item">
          <a href="https://vk.com/habr" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_vkontakte" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;vkontakte&#39;); }" rel=" noopener">
            <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M16.066 11.93s1.62-2.286 1.782-3.037c.054-.268-.064-.418-.343-.418h-1.406c-.322 0-.44.139-.537.343 0 0-.76 1.619-1.685 2.64-.297.33-.448.429-.612.429-.132 0-.193-.11-.193-.408v-2.607c0-.365-.043-.472-.343-.472h-2.254c-.172 0-.279.1-.279.236 0 .343.526.421.526 1.352v1.921c0 .386-.022.537-.204.537-.483 0-1.631-1.663-2.274-3.552-.129-.386-.268-.494-.633-.494h-1.406c-.204 0-.354.139-.354.343 0 .375.44 2.114 2.167 4.442 1.159 1.566 2.683 2.414 4.056 2.414.838 0 1.041-.139 1.041-.494v-1.202c0-.301.118-.429.29-.429.193 0 .534.062 1.33.848.945.901 1.01 1.276 1.525 1.276h1.578c.161 0 .311-.075.311-.343 0-.354-.462-.987-1.17-1.738-.29-.386-.762-.805-.912-.998-.215-.226-.151-.354-.001-.59z"></path></svg>
          </a>
        </li>
      <li class="social-icons__item">
        <a href="https://telegram.me/habr_com" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_telegram" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;telegram&#39;); }" rel=" noopener">
          <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="24" height="24" viewBox="0 0 24 24"><path d="M17.17 7.621l-10.498 3.699c-.169.059-.206.205-.006.286l2.257.904 1.338.536 6.531-4.796s.189.057.125.126l-4.68 5.062-.27.299.356.192 2.962 1.594c.173.093.397.016.447-.199.058-.254 1.691-7.29 1.728-7.447.047-.204-.087-.328-.291-.256zm-6.922 8.637c0 .147.082.188.197.084l1.694-1.522-1.891-.978v2.416z"></path></svg>
        </a>
      </li>
        <li class="social-icons__item">
          <a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_youtube" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;youtube&#39;); }" rel=" noopener">
            <svg class="icon-svg" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="32" height="32" viewBox="0 0 32 32"><path d="M3.2 0h25.6c1.767 0 3.2 1.433 3.2 3.2v25.6c0 1.767-1.433 3.2-3.2 3.2h-25.6c-1.767 0-3.2-1.433-3.2-3.2v-25.6c0-1.767 1.433-3.2 3.2-3.2zm18.133 16l-10.667-5.333v10.667l10.667-5.333z"></path></svg>

          </a>
        </li>
        <li class="social-icons__item">
          <a href="https://zen.yandex.ru/habr" class="social-icons__item-link social-icons__item-link_normal social-icons__item-link_zen" target="_blank" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;footer&#39;, &#39;Social_icons&#39;, &#39;zen&#39;); }" rel=" noopener">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon-svg" width="32" height="32" viewBox="0 0 32 32"><path fill="#f00" d="M3.2 0h25.6c1.767 0 3.2 1.433 3.2 3.2v25.6c0 1.767-1.433 3.2-3.2 3.2h-25.6c-1.767 0-3.2-1.433-3.2-3.2v-25.6c0-1.767 1.433-3.2 3.2-3.2z"></path><path fill="#d00000" d="M13.661 32h-6.157l12.409-9.537 2.44 2.811-8.693 6.726zm3.782-32h5.883l-10.515 8.777-2.44-2.811 7.072-5.966z"></path><path fill="#f8b3b2" d="M10.4 17.879l9.474-7.314 2.441 2.812-9.475 7.314z"></path><path fill="#fff" d="M10.417 5.954l11.909 3.897v3.543l-11.909-3.897v-3.543zm0 11.909l11.909 3.897v3.543l-11.909-3.897v-3.543z"></path></svg>

          </a>
        </li>
    </ul>
  </div>
</div>

        </div>
      </div>

      <a href="https://habr.com/ru/post/343778/#" class="layout__elevator" id="scroll_to_top" title="Наверх" onclick="if (typeof ga === &#39;function&#39;) { ga(&#39;send&#39;, &#39;event&#39;, &#39;navigation_button&#39;, &#39;down&#39;); }">
        <svg class="icon-svg icon-svg_scroll-up" width="32" height="32" viewBox="0 0 32 32" aria-hidden="true" version="1.1" role="img"><path d="M16 0C7.164 0 0 7.164 0 16s7.164 16 16 16 16-7.164 16-16S24.836 0 16 0zm8.412 19.523c-.517.512-1.355.512-1.872 0L16 13.516l-6.54 6.01c-.518.51-1.356.51-1.873 0-.516-.513-.517-1.343 0-1.855l7.476-7.326c.517-.512 1.356-.512 1.873 0l7.476 7.327c.516.513.516 1.342 0 1.854z"></path></svg>
      </a>
    </div>

    <div class="overlay hidden" id="js-lang_settings">
  <div class="popup">
    <div class="popup__head popup__head_lang-settings">
      <span class="popup__head-title js-popup_title" data-section="1">Настройка языка</span>
      <button type="button" class="btn btn_small btn_popup-close js-hide_lang_settings">
        <svg class="icon-svg" width="12" height="12">
          <use xlink:href="https://habr.com/images/1557305357/common-svg-sprite.svg#close"></use>
        </svg>
      </button>
    </div>
    <div class="popup__body">
      <form action="https://habr.com/json/settings/i18n/" method="post" class="form form_lang-settings" id="lang-settings-form">
        <fieldset class="form__fieldset form__fieldset_thin" data-section="2">
          <legend class="form__legend form__legend_lang-settings js-popup_hl_legend">Интерфейс</legend>
            <div class="form-field form-field_lang-settings">
              <label class="radio radio_custom ">
                <input type="radio" name="hl" id="hl_langs_ru" class="radio__input js-hl_langs" value="ru" checked="">
                <span class="radio__label radio__label_another">Русский</span>
              </label>
            </div>
            <div class="form-field form-field_lang-settings">
              <label class="radio radio_custom ">
                <input type="radio" name="hl" id="hl_langs_en" class="radio__input js-hl_langs" value="en">
                <span class="radio__label radio__label_another">English</span>
              </label>
            </div>
        </fieldset>

        <fieldset class="form__fieldset form__fieldset_thin">
          <legend class="form__legend form__legend_lang-settings js-popup_fl_legend" data-section="3">Язык публикаций</legend>
            <div class="form-field form-field_lang-settings">
              <label class="checkbox checkbox_custom">
                <input type="checkbox" name="fl[]" id="fl_langs_ru" class="checkbox__input js-fl_langs" value="ru" checked="">
                <span class="checkbox__label checkbox__label_another js-popup_feed_ru">Русский</span>
              </label>
            </div>
            <div class="form-field form-field_lang-settings">
              <label class="checkbox checkbox_custom">
                <input type="checkbox" name="fl[]" id="fl_langs_en" class="checkbox__input js-fl_langs" value="en">
                <span class="checkbox__label checkbox__label_another js-popup_feed_en">English</span>
              </label>
            </div>
        </fieldset>

        <div class="form__footer form__footer_lang-settings">
          <button type="submit" class="btn btn_blue btn_huge btn_full-width js-popup_save_btn">Сохранить настройки</button>
        </div>
      </form>
    </div>
  </div>
</div>



    <script type="text/javascript">
  // global vars
  var g_base_url = 'habr.com/ru';
  var g_base_fullurl = 'https://habr.com/ru/';
  var g_tmid_fullurl = 'https://account.habr.com/';
  var g_is_guest = false;
  var g_show_xpanel = false;
  var g_is_enableShortcuts = '1';
    var g_current_hl = 'ru';
    var g_current_fl = 'ru';

</script>

    <script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/vendors.bundle.js"></script>
    <script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/main.bundle.js"></script>
      <script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    showProcessingMessages: false,
    showMathMenu: true,
    tex2jax: {
      inlineMath: [['$inline$','$inline$']],
      displayMath: [['$$display$$','$$display$$']],
      processEscapes: true
    },
    MathMenu: {
      showRenderer: true,
      showContext:  true
    }
  });

  MathJax.Extension.Img2jax = {
    PreProcess: function (element) {
      var hasMath = false;
      var images = element.querySelectorAll('[data-tex]');
      for (var i = images.length - 1; i >= 0; i--) {
        var img = images[i];
        var tex = img.alt.replace(/(\r\n|\n|\r)/gm, " ");
        if (tex && tex[0] === '$'){
          var script = document.createElement("script"); script.type = "math/tex";
          hasMath = true;
          if (img.getAttribute('data-tex') == "display"){script.type += ";mode=display"}
          MathJax.HTML.setScript(script, tex.substring(1,tex.length-1));
          img.parentNode.replaceChild(script,img);
        }
      }
    }
  };

  MathJax.Hub.Register.PreProcessor(["PreProcess", MathJax.Extension.Img2jax]);
</script>

<script type="text/javascript" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/MathJax.js">
</script>



      <script src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/check-login.js"></script>

      <script type="text/javascript" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/saved_resource(2)"></script>

    
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            if (typeof (_yaparams) != 'undefined') {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    params:_yaparams});
            } else {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
            }

        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript>&lt;div&gt;&lt;img src="//mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" /&gt;&lt;/div&gt;</noscript>
<!-- /Yandex.Metrika counter -->

    <!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');

    fbq('init', '317458588730613');
    fbq('track', 'PageView');
</script>
<noscript>
        &lt;img height="1" width="1" src="https://www.facebook.com/tr?id=317458588730613&amp;ev=PageView&amp;noscript=1"/&gt;
</noscript>
<!-- End Facebook Pixel Code -->
    
  

<div id="AutocompleteContainter_52fab" style="position: absolute; z-index: 9999; top: 0px; left: 0px;"><div class="autocomplete-w1"><div class="autocomplete" id="Autocomplete_52fab" style="display: none; width: 300px; max-height: 400px;"></div></div></div><div id="AutocompleteContainter_e4060" style="position: absolute; z-index: 9999; top: 38px; left: 0px;"><div class="autocomplete-w1"><div class="autocomplete" id="Autocomplete_e4060" style="display: none; width: 300px; max-height: 400px;"></div></div></div><iframe id="google_osd_static_frame_1467787789543" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./Шаблон проектирования Entity-Component-System — реализация и пример игры _ Хабр_files/saved_resource(3).html"></iframe></body></html>